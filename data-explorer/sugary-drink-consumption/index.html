<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Sugary drink consumption data for NYC.&#x7c; Environment &amp; Health Data Portal</title>


<meta name="description" content="Here is the site global SEO description">
<link rel="canonical" href="https://nychealth.github.io/EH-dataportal/data-explorer/sugary-drink-consumption/" />
<meta name="robots" content="all" />
<meta name="geo.region" content="" />
<meta name="geo.placename" content="Environment &amp; Health Data Portal" />


<meta property="fb:profile_id" content="0" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_us" />
<meta property="og:url" content="https://nychealth.github.io/EH-dataportal/data-explorer/sugary-drink-consumption/" />
<meta property="og:title" content="Sugary drink consumption data for NYC.&ndash; Environment &amp; Health Data Portal" />
<meta property="og:description" content="Explore data, visualizations, and more." />
<meta property="og:site_name" content="Environment &amp; Health Data Portal" />
<meta property="og:image" content="https://nychealth.github.io/EH-dataportal/images/report_bottom_background_hu55023dbc37de342337a21cf33dcc5889_222582_2400x1260_fill_q75_box_smart1.jpg"><meta property="og:see_also" content="https://twitter.com/nycHealthy" />
<meta name="twitter:title" content="Sugary drink consumption data for NYC.&ndash; Environment &amp; Health Data Portal">
<meta name="twitter:description" content="Explore data, visualizations, and more.">
<meta name="twitter:image" content="/images/report_bottom_background.jpg">
<meta name="twitter:site" content="@nycHealthy">
<meta name="twitter:creator" content="@nycHealthy">
<script src="https://code.jquery.com/jquery-3.3.1.min.js" 
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" 
    crossorigin="anonymous"></script>


<link rel="stylesheet" href="../../fontawesome/css/all.min.css">

<link rel="stylesheet" href="https://nychealth.github.io/EH-dataportal/scss/theme.css" />


<script src="https://cdn.jsdelivr.net/npm/dompurify@2.3.10/dist/purify.min.js" 
    integrity="sha256-keaR/uWEpEmmUnoJ6BemH9gp9Ng8u/YplhVwdmmquNY=" 
    crossorigin="anonymous"></script>

</head>
<body>
  
  
<a class="sr-only sr-only-focusable skip-menu" href="#skip-header-target">Skip Header</a>

<header id="global-header" role="banner">

    <div class="bg-black text-white" id="nyc-top-header">

        <div class="container-fluid wide">

            <div class="row py-1 align-items-center justify-content-between">

                <div class="col-auto">
                    <p class="d-none d-md-flex fs-md">
                        <a class="text-reset" href="https://www1.nyc.gov/">
                            <strong>nyc.gov</strong>
                        </a>
                        <span class="mx-1" aria-hidden="true">|</span>
                        Health
                    </p>
                </div>
                

                <div class="col-auto">

                    <ul class="extensible-list horizontal fs-md">
                        <li>
                            <a class="text-reset" href="https://www1.nyc.gov/">
                                <strong>
                                    311
                                </strong>
                            </a>
                        </li>
                        <li>
                            <a class="text-reset" href="https://www1.nyc.gov/home/search/index.page">
                                <strong>
                                    Search all NYC.gov
                                </strong>
                            </a>
                        </li>
                        <li>
                            <a href="https://www1.nyc.gov/" title="Go to nyc.gov">
                                <img class="d-block" src="../../images/nyc-bubble-logo.svg" width="45" alt="NYC Logo">
                            </a>
                        </li>
                    </ul>

                </div>
                

            </div>
            

        </div>
        

    </div>
    
    <div class="site-header bg-primary" style="background-image: url(/EH-dataportal/images/header_background.jpg)">
        <div class="wrap-header">

            <div class="container-fluid wide">

                <div class="row align-items-center">

                    <div class="col-lg py-4 pl-md-5">

                        <div class="d-flex justify-content-center justify-content-lg-start">

                            <p class="text-white">
                                <span class="site-title">Environment and Health Data Portal</span>
                                <span class="site-subtitle">Explore data on how environments shape health in New York
                                    City</span>
                            </p>


                        </div>
                        

                    </div>
                    

                    <div class="col-lg-auto border-top border-lg-0">

                        <div class="row no-gutters justify-content-between py-2">

                            
                            <div class="col-auto d-flex d-lg-none">

                                <button class="no-btn-style" type="button" data-toggle="collapse"
                                    data-target="#nav-primary" aria-controls="nav-primary" aria-expanded="false"
                                    aria-label="Toggle navigation">
                                    <span class="fas fa-bars fa-lg"></span>
                                </button>

                            </div>
                            

                            <div class="col-auto">

                                <ul class="extensible-list horizontal">
                                    <li>
                                        <button class="no-btn-style" type="button" title="Language"
                                            data-toggle="collapse" data-target="#global-language"
                                            aria-controls="global-language" aria-expanded="false">
                                            <span class="sr-only">Language</span>
                                            <span class="fas fa-language fa-2x"></span>
                                        </button>
                                    </li>
                                    <li>
                                        <button class="no-btn-style" type="button" title="Search" data-toggle="collapse"
                                            data-target="#global-search" aria-controls="global-search"
                                            aria-expanded="false">
                                            <span class="sr-only">Search</span>
                                            <span class="fas fa-search fa-lg"></span>
                                        </button>
                                    </li>
                                </ul>

                            </div>
                            

                        </div>
                        

                    </div>
                    

                </div>
                

            </div>
            

        </div>
        

        <div class="container-fluid border-top collapse" id="global-language">
            <div class="narrow py-2">
                <div id="google_translate_element"></div>
            </div>
        </div>

        <div class="container-fluid border-top collapse" id="global-search">
            <form class="narrow py-2" aria-label="Search" role="search">
                <div class="input-group">
                    <label class="sr-only" for="global-search-bar">Search</label>
                    <input class="form-control form-control-lg" id="global-search-bar" placeholder="Search">
                    <div class="input-group-btn">
                        <button class="btn btn-primary btn-lg" type="button" title="Search">
                            <span class="sr-only">Search</span>
                            <span class="fas fa-arrow-right"></span>
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="container-fluid collapse d-lg-block px-0 border-lg-top" id="nav-primary">

        <div class="wide"> 

            <nav class="nav nav-pills border-bottom" role="navigation"><div class="nav-item">

                    <a class="nav-link" href="../../" id="nav-item-01">
                        <span class='text-primary'><i class='fa fa-home' aria-hidden='true'></i></span> Home
                    </a>

                </div>
                <div class="nav-item">

                    <a class="nav-link" href="../../data-stories/" id="nav-item-02">
                        <span class='text-primary'><i class='fas fa-passport' aria-hidden='true'></i></span> Data Stories
                    </a>

                </div>
                <div class="nav-item">

                    <a class="nav-link" href="../../neighborhood-reports/" id="nav-item-04">
                        <span class='text-primary'><i class='fas fa-map-marked-alt' aria-hidden='true'></i></span> Neighborhood Reports
                    </a>

                </div>
                <div class="nav-item">

                    <a class="nav-link" href="../../key-topics/" id="nav-item-05">
                        <span class='text-primary'><i class='fas fa-star' aria-hidden='true'></i></span> Key Topics
                    </a>

                </div>
                <div class="nav-item active">

                    <a class="nav-link" href="../../data-explorer/" id="nav-item-03">
                        <span class='text-primary'><i class='fas fa-chart-line' aria-hidden='true'></i></span> Data Explorer
                    </a>

                </div>
                </nav>

        </div>
        

    </div>

</header>
<main id="skip-header-target" role="main">

<article class="container-fluid" id="skip-header-target">
    <div class="row">
        <div class="col-md-11 mx-auto mt-4 mx-1">
            <nav aria-label="breadcrumb" class="mb-2">
                <ul class="breadcrumb mr-auto">
                    <li class="breadcrumb-item"><a href="https://nychealth.github.io/EH-dataportal/">Home</a></li>
                    <li class="breadcrumb-item"><a href="https://nychealth.github.io/EH-dataportal//data-explorer/">Data Explorer</a></li>
                    <li class="breadcrumb-item active"><a href="../../data-explorer/sugary-drink-consumption/">Sugary Drink Consumption</a></li>
                    <li class="nav-item ml-auto">
                        <button type="button" class="btn btn-sm btn-outline-primary" data-toggle="modal" data-target="#topicModal">
                            Change topic
                          </button>
                        
                          
                        
                    </li>
                </ul>                
            </nav>

            <div class="row mb-1">
                <div class="col mx-2 ml-0 pl-0 py-2">
                    <h2>Sugary Drink Consumption</h2>
                </div>
            </div>

            <style>
                 
                [aria-expanded="false"] > .expanded,
                [aria-expanded="true"] > .collapsed {
                  display: none;
                }

                #truncate {
                    display: block;
                }

                #full {
                    display: none;
                }

                #expand-collapse {
                    cursor: pointer;
                }

                .show {
                display: block!important;
                }

                .hide {
                display: none!important;
                }

                 

                .dropdown-title {
                    padding: 0.25rem 1.5rem;
                }

                .indicator-measures h6 {
                    margin-top: 0.5em;
                }

                .dropdown-menu {
                    z-index: 2000;
                }



                div[aria-labelledby="dropdownMapMeasures"].show {
                    display: flex !important;
                }

            </style>

            
            <script src="https://cdn.jsdelivr.net/npm/apache-arrow@latest"></script>
            <script src="https://cdn.jsdelivr.net/npm/arquero@latest"></script>

            
            <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>

            
            <script src="https://cdn.jsdelivr.net/npm/vega@5.21.0"></script>
            <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.2.0"></script>
            <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.20.2"></script>
            
            
            <script src="https://d3js.org/d3.v5.min.js"></script>

            
            <script src="../../js/data-explorer/summary.js"></script>
            <script src="../../js/data-explorer/map.js"></script>
            <script src="../../js/data-explorer/trend.js"></script>
            <script src="../../js/data-explorer/links.js"></script>

            <script>
                    let data_branch = "staging";
                    let data_repo = "https://raw.githubusercontent.com/nychealth/EHDP-data";
                    let indicators = []; 
                    let defaultIndicatorId;
                    let selectedSummaryYears = [];
                    let selectedSummaryGeography = [];
                    let aboutMeasures;
                    let dataSources;

                    let measureAbout = `N/A`;
                    let measureSources = `N/A`;
                    let geoTable;
                    let aqData;
                    let joinedAqData;

                    let hasCIData = false;
                    let hasNumberData = false;
                    let hasPercentData = false;

                    let fullDataMapObjects;
                    let fullDataTrendObjects;
                    let fullDataLinksObjects;
                    let joinedDataLinksObjects;
                    let joinedDataTrendDisparityObjects;

                    let indicator;
                    let indicatorName;
                    let indicatorDesc;
                    let indicatorShortName;
                    let indicatorMeasurses;
                    let indicatorId;

                    let defaultTrendMeasure = [];
                    let defaultTrendAbout;
                    let defaultTrendSources;
                    let defaultMapMeasure = [];
                    let defaultMapAbout;
                    let defaultMapSources;
                    let defaultLinksMeasure = [];
                    let defaultLinkMeasureTimes = [];
                    let defaultLinksAbout;
                    let defaultLinksSources;

                    let selectedMapMeasure = false
                    let selectedTrendMeasure = false;
                    let selectedLinksMeasure = false;
                    let selectedMapAbout;
                    let selectedMapSources;
                    let selectedTrendAbout;
                    let selectedTrendSources;
                    let selectedLinksAbout;
                    let selectedLinksSources;
                    let selectedLinkMeasureData = [];
                    let selectedlinksSecondaryIndicatorData = [];
                    let selectedlinksSecondaryMeasureData = [];
                    let selectedlinksSecondaryMeasureTime;
                    
                    let mapMeasures = [];
                    let trendMeasures = [];
                    let linksMeasures = [];

                    let tabMap;
                    let tabTrend;
                    let tabLinks;

                    let currentHash;

                    const url = new URL(window.location);
                
                    const updateChartPlotSize = () => {
                        setTimeout(() => {
                            window.dispatchEvent(new Event('resize'));
                        }, 200)

                    }

                    window.onpopstate = function (event) {
                        if (event.state != null){
                            
                            document.url = event.state.url;                            
                            loadIndicator(event.state.id, true)
                        }
                    };

                    window.addEventListener("hashchange", function () {
                        const hash =  window.location.hash.replace('#', "");
                        currentHash = hash;

                        switch(hash) {
                            case 'display=summary':
                                $('#tab-btn-table').tab('show');
                            break;
                            case 'display=map':
                                $('#tab-btn-map').tab('show');
                            break;
                            case 'display=trend':
                                $('#tab-btn-trend').tab('show');
                            break;
                            case 'display=links':
                                $('#tab-btn-links').tab('show');
                            break;
                            default: 
                            $('#tab-btn-table').tab('show');
                            break;
                        }
                    });

                    document.addEventListener("DOMContentLoaded", () => {
                        tabTable = document.querySelector('#tab-btn-table');
                        tabMap = document.querySelector('#tab-btn-map');
                        tabTrend = document.querySelector('#tab-btn-trend');
                        tabLinks = document.querySelector('#tab-btn-links');
                        aboutMeasures = document.querySelector('.indicator-measures');
                        dataSources = document.querySelector('.indicator-sources');
                    });


                    function reveal() {
                        document.getElementById('truncate').classList.toggle('hide');
                        document.getElementById('full').classList.toggle('show');
                        document.getElementById('contenttoggle').innerHTML = `Show less... <i class="fas fa-caret-square-up" aria-hidden="true"></i>`;
                    }
                    

                    fetch(data_repo + "/" + data_branch + '/indicators/indicators.json')
                        .then(response => response.json())
                        .then(data => {
                            indicators = data;
                            const paramId =  url.searchParams.get('id') !== null ? parseInt(url.searchParams.get('id')) : false;
                            const paramDisplay =  url.searchParams.get('display') !== null ? url.searchParams.get('display') : false

                            const renderIndicatorDropdown = () => {
                                const indicatorDropdown = document.getElementById("indicator-dropdown");
                                let indicatorId;
                                let header;
                                
                                
                                        header = ``;
                                        // console.log('Header: ', header)
                                        indicatorDropdown.innerHTML += header.length ? `<div class="dropdown-title"><strong>${header}</strong></div>`: '';
                                        
                                            
                                                defaultIndicatorId = 2097
                                            
                                            indicatorId = 2097
                                            indicator = indicators.find(indicator => indicator.IndicatorID === indicatorId);
                                            indicatorName = indicator?.IndicatorName ? indicator.IndicatorName : 'N/A';
                                            indicatorDropdown.innerHTML += `<button class="dropdown-item" onclick="loadIndicator(${indicatorId})" data-internal-id="${indicatorId}">${indicatorName}</button>`
                                        
                                            
                                            indicatorId = 2098
                                            indicator = indicators.find(indicator => indicator.IndicatorID === indicatorId);
                                            indicatorName = indicator?.IndicatorName ? indicator.IndicatorName : 'N/A';
                                            indicatorDropdown.innerHTML += `<button class="dropdown-item" onclick="loadIndicator(${indicatorId})" data-internal-id="${indicatorId}">${indicatorName}</button>`
                                        
                                
                            }


                            renderIndicatorDropdown()
                            if (paramId) {
                                loadIndicator(paramId)
                            } else {
                                loadIndicator()
                            }

                            const hash =  window.location.hash.replace('#', "")
                            // console.log('hash:', window.location.hash, hash)
                            
                            switch(hash) {
                                case 'display=summary':
                                    $('#tab-btn-table').tab('show');
                                    break;
                                case 'display=map':
                                    $('#tab-btn-map').tab('show');
                                    break;
                                case 'display=trend':
                                    $('#tab-btn-trend').tab('show');
                                    break;
                                case 'display=links':
                                    $('#tab-btn-links').tab('show');
                                 break;
                                default: 
                                    $('#tab-btn-table').tab('show');
                            }
                        })
                        .catch(error => console.log(error));




                    // join the data
                    const joinData = () => {
                        if (hasCIData && hasNumberData) {
                            joinedAqData = aqData
                                .join_left(geoTable, [["GeoID", "GeoType"], ["GeoID", "GeoType"]])
                                .relocate(['Name'], { after: 'GeoID' })
                                .relocate(['GeoType'], { before: 'GeoID' })
                                .rename({
                                    'Name': 'Geography',
                                })
                                .relocate(aq.startswith("Number"), { after: "Geography" })
                                
                        } else if (hasCIData && !hasNumberData && hasPercentData) {
                            joinedAqData = aqData
                                .join_left(geoTable, [["GeoID", "GeoType"], ["GeoID", "GeoType"]])
                                .relocate(['Name'], { after: 'GeoID' })
                                .relocate(['GeoType'], { before: 'GeoID' })
                                .rename({
                                    'Name': 'Geography',
                                })
                                
                        } else {
                            joinedAqData = aqData
                                .join_left(geoTable, [["GeoID", "GeoType"], ["GeoID", "GeoType"]])
                                .relocate(['Name'], { after: 'GeoID' })
                                .relocate(['GeoType'], { before: 'GeoID' })
                                .rename({
                                    'Name': 'Geography',
                                })
                        }

                        console.log("============ joinedAqData ============", joinedAqData);

                        const filterUHF42 = joinedAqData.filter(d => d.GeoType == 'UHF42').objects();
                        const filterUHF34 = joinedAqData.filter(d => d.GeoType == 'UHF34').objects();
                        const filterCD = joinedAqData.filter(d => d.GeoType == 'CD').objects();
                        const filterNTA = joinedAqData.filter(d => d.GeoType == 'NTA').objects();
                        const filterPuma = joinedAqData.filter(d => d.GeoType == 'Puma').objects();
                        const filterSubboro = joinedAqData.filter(d => d.GeoType == 'Subboro').objects();
                        const filterBorough = joinedAqData.filter(d => d.GeoType  == 'Borough').objects();
                        const filterCitywide = joinedAqData.filter(d => d.GeoType  == 'Citywide').objects();
                        const filterNYCKids = joinedAqData.filter(d => d.GeoType  == 'NYCKIDS').objects();

                        console.log('$$$$ KIDS ', filterNYCKids)
                        // console.log('hhhhhhh ',aqData, joinedAqData )
                        // console.log('===>', filterUHF42, filterUHF34, filterCD, filterPuma, filterSubboro, filterBorough, filterCitywide)
                        // geoTable.print()
                                
                        // joinedAqData.print()


                        fullDataMapObjects = [...filterUHF42, ...filterUHF34, ...filterCD, ...filterPuma, ...filterSubboro, ...filterNTA, ...filterNYCKids ];
                        // console.log('fullDataMapObjects', fullDataMapObjects)
                        fullDataTrendObjects = [...filterBorough, ...filterCitywide];
                        fullDataLinksObjects = joinedAqData.objects();

                        console.log("==== joinedAqData ====");
                        joinedAqData.print({limit: 100})
                        console.log(joinedAqData);

                        renderMeasures();
                    }

                    const loadGeo = () => {
                        const geoUrl = `https://raw.githubusercontent.com/nychealth/EHDP-data/staging/geography/GeoLookup_2.csv`; // col named "GeoType"
                        

                        aq.loadCSV(geoUrl)
                            .then(data => {

                                const standardizeGeoId = (id, type) => {
                                    // if (type === 'NTA') {
                                    //     return `${id}`;
                                    // }
                                    return parseInt(id)
                                }
                                geoTable = data
                                    .derive({ GeoID: aq.escape(d => standardizeGeoId(d.GeoID, d.GeoType))}) // convert GeoIDs to numbers and strings
                                    .select(aq.not('Lat', 'Long'))
                                console.log("---- Geo Names 1 (post-load) ----")
                                geoTable.print({ limit: 10});
                                joinData(); // run the next function 
                            });
                    }

                    const loadData = (indicatorId) => {
                        // Loads data as an arquero table
                        fetch(data_repo + "/" + data_branch + `/indicators/data/${indicatorId}.json`)
                            .then(response => response.json())
                            .then(data => {

                                loadGeo(); // run the next function

                                const ciAqData = data.filter(d => d.CI.length > 0 )
                                
                                const numAqData = data.filter(d => d.MeasurementType === "Number")
                                const pctAqData = data.filter(d => d.MeasurementType === "Percent")
                                // Pesticide Measurement Types
                                const sprayBombPct = data.filter(d => d.MeasurementType === "Spray/Bomb Only - %")
                                const saferMethodsNumber = data.filter(d => d.MeasurementType === "Only Safer Methods (Bait,Gel, Boric Acid) - Number")
                                const saferMethodsPct = data.filter(d => d.MeasurementType === "Only Safer Methods (Bait,Gel, Boric Acid) - %")
                                const anyUseNumber = data.filter(d => d.MeasurementType === "Any Use - Number")
                                const anyUsePct = data.filter(d => d.MeasurementType === "Any Use - %")
                                const anyUseTempoPct = data.filter(d => d.MeasurementType === "Any use of Tempo or Chinese Chalk - %")

                                hasCIData = ciAqData.length > 0;
                                hasNumberData = numAqData.length > 0;
                                hasPercentData = pctAqData.length > 0;
                                // console.log('data: ', data)
                                // console.log('CI: ', ciAqData)
                                // console.log('Number: ', pctAqData)
                                // console.log('Percent: ', pctAqData)
                                // console.log('Stripped: ', data)


                                const assignGeoRank = (GeoType) => {
                                    switch (GeoType) {
                                        case 'Citywide':
                                            return 0;
                                        case 'Borough':
                                            return 1;
                                        case 'NYCKIDS':
                                            return 2;
                                        case 'UHF34':
                                            return 3;
                                        case 'UHF42':
                                            return 4;
                                        case 'Subboro':
                                            return 5;
                                        case 'CD':
                                            return 6;
                                        case 'NTA':
                                            return 7;
                                    }
                                }

                                let pct;
                                let num;
                                let ful;
                                let str;
                                let aUNum;
                                let aUTPct;
                                let aUPct;
                                let sMPct;
                                let sBPct;

                                ful = aq.from(data)
                                        .groupby("Time", "GeoType", "GeoID", { "GeoRank": aq.escape( d => assignGeoRank(d.GeoType))})
                                        // .impute({ Value: () => "**" })
                                        .pivot("MeasurementType", "Value")

                                        

                                console.log('==== ful ====')
                                ful.print({limit: 100})
                                console.log(ful)

                                if (hasCIData) {
                                    // console.log('---- new table ----------')
                                    const dataMeasurementTypes = [...new Set(data.map(item => item.MeasurementType))]
                                    // console.log(dataMeasurementTypes, data)
                                    if (pctAqData.length > 0) {
                                    pct = aq.from(pctAqData)
                                                .groupby("Time", "GeoType", "GeoID", "CI")
                                                //  .groupby("Time", "GeoType", "GeoID", "CI", { "Percent (95% CL)": d => d.Value !== null ? d.DisplayValue + " " + d.CI: "**" })
                                                .impute({ Value: () => "**" })
                                                .pivot("MeasurementType", "Value")
                                                .rename({ CI: "CI (95%)"})

                                    // pct.print();
                                }
                                
                                if (numAqData.length > 0) {
                                    num = aq.from(numAqData)
                                                .groupby("Time", "GeoType", "GeoID")
                                                .impute({ Value: () => "**" })
                                                .pivot("MeasurementType", "Value")

                                    // num.print();
                                }


                                if (sprayBombPct.length > 0) {
                                    sBPct = aq.from(sprayBombPct)
                                                .groupby("Time", "GeoType", "GeoID")
                                                .impute({ Value: () => "**" })
                                                .pivot("MeasurementType", "Value")

                                                // console.log('sprayBombPct-------------------------------------------------')
                                                // sBPct.print()
                                } 
                                if (saferMethodsPct.length > 0) {
                                    sMPct = aq.from(saferMethodsPct)
                                                .groupby("Time", "GeoType", "GeoID")
                                                .impute({ Value: () => "**" })
                                                .pivot("MeasurementType", "Value")

                                                // console.log('saferMethodsPct-------------------------------------------------')
                                                // sMPct.print()
                                }
                               
                                if (anyUseNumber.length > 0) {
                                    aUNum = aq.from(anyUseNumber)
                                                .groupby("Time", "GeoType", "GeoID")
                                                .impute({ Value: () => "**" })
                                                .pivot("MeasurementType", "Value")

                                                 // console.log('anyUseNumber-------------------------------------------------')
                                                 // aUNum.print()
                                }

                                if (anyUsePct.length > 0) {
                                    aUPct = aq.from(anyUsePct)
                                                .groupby("Time", "GeoType", "GeoID")
                                                .impute({ Value: () => "**" })
                                                .pivot("MeasurementType", "Value")

                                                // console.log('anyUsePct-------------------------------------------------')
                                                // aUPct.print()
                                }
                                
                                if (anyUseTempoPct.length > 0) {
                                    aUTPct = aq.from(anyUseTempoPct)
                                                .groupby("Time", "GeoType", "GeoID", "CI")
                                                .impute({ Value: () => "**" })
                                                .pivot("MeasurementType", "Value")

                                                // console.log('anyUseTempoPct-------------------------------------------------')
                                                // aUTPct.print()
                                }
                                
                                // if (strippedAqData.length > 0) {
                                //     str = aq.from(strippedAqData)
                                //                 .groupby("Time", "GeoType", "GeoID", { "GeoRank": aq.escape( d => assignGeoRank(d.GeoType))})
                                //                 .impute({ Value: () => "**" })
                                //                 .pivot("MeasurementType", "Value")
                                // } else {
                                     
                                // }
                                
                                                
                                
                            
                                let newTable;
                                if (pctAqData.length > 0 && numAqData.length > 0) {
                                    // if (strippedAqData.length > 0) {
                                    // newTable = str
                                    //             .join(num, [["GeoID", "GeoType", "Time"], ["GeoID", "GeoType", "Time"]])
                                    //             .join(pct, [["GeoID", "GeoType", "Time"], ["GeoID", "GeoType", "Time"]])
                                    //             .orderby(aq.desc('Time'), 'GeoRank')
                                    // } else {
                                        // console.log('test', ful)
                                        
                                        newTable = ful
                                            .join(num, [["GeoID", "GeoType", "Time", "Number"], ["GeoID", "GeoType", "Time", "Number"]])
                                            .join(pct, [["GeoID", "GeoType", "Time", "Percent"], ["GeoID", "GeoType", "Time", "Percent"]])
                                            .orderby(aq.desc('Time'), 'GeoRank')


                                        
                                        // }
                                        // } else if (pctAqData.length > 0 && numAqData.length === 0) {
                                //     newTable =  aq.from(strippedAqData)
                                //                 .join(num, [["GeoID", "GeoType", "Time"], ["GeoID", "GeoType", "Time"]])
                                //                 .join(pct, [["GeoID", "GeoType", "Time"], ["GeoID", "GeoType", "Time"]])
                                //                 .orderby(aq.desc('Time'), aq.desc('GeoRank'),  'Geography')
                                } else if (pctAqData.length === 0 && numAqData.length === 0 && sprayBombPct.length > 0 && saferMethodsPct.length > 0 && anyUseNumber.length > 0 && anyUsePct.length > 0 && anyUseTempoPct.length > 0) {
                                    // console.log('NO NUMBER OR PERCENT')
                                    newTable = ful
                                            .groupby("Time", "GeoType", "GeoID")
                                            // .join(aUNum)
                                            // .join(aUTPct)
                                        .join_left(sBPct, [["GeoID", "GeoType", "Time", "Spray/Bomb Only - %"], ["GeoID", "GeoType", "Time", "Spray/Bomb Only - %"]])
                                        .join_left(sMPct, [["GeoID", "GeoType", "Time", "Only Safer Methods (Bait,Gel, Boric Acid) - %"], ["GeoID", "GeoType", "Time", "Only Safer Methods (Bait,Gel, Boric Acid) - %"]])
                                        .join_left(aUNum, [["GeoID", "GeoType", "Time", "Any Use - Number"], ["GeoID", "GeoType", "Time", "Any Use - Number"]])
                                        .join_left(aUPct, [["GeoID", "GeoType", "Time", "Any Use - %"], ["GeoID", "GeoType", "Time", "Any Use - %"]])
                                        .join_left(aUTPct, [["GeoID", "GeoType", "Time", "Any use of Tempo or Chinese Chalk - %"], ["GeoID", "GeoType", "Time", "Any use of Tempo or Chinese Chalk - %"]])
                                        // .join(aUTPct, [["GeoID", "GeoType", "Time", "Any use of Tempo or Chinese Chalk - %"], ["GeoID", "GeoType", "Time", "Any use of Tempo or Chinese Chalk - %"]])
                                        .orderby(aq.desc('Time'), aq.desc('GeoRank'), 'Geography')
                                        // console.log('newTable', newTable)
                                } else {
                                    newTable = ful
                                        .groupby("Time", "GeoType", "GeoID")
                                
                                }

                                console.log('==== newTable ====')
                                newTable.print({limit: 100})
                                console.log(newTable)
                                

                                // console.log('newTable====================================')
                                // newTable.print();
                                aqData = newTable
                                    // aqData = aq.from(data)
                                    //     // .except([pct, num])
                                    //     .semijoin(pct, [["GeoType"], ["GeoType"]])
                                    //     .semijoin(pct, [["GeoType"], ["GeoType"]])
                                        // .groupby("Time", "GeoType", "GeoID", "CI")
                                        // .groupby({ abc: d => d.MeasurementType + d.Time})
                                        
                                        // .pivot("MeasurementType", "DisplayValue")

                                        // .relocate(["Time"], { before: "MeasureID" })
                                        // .relocate(["GeoType"], { after: "Time" })
                                        // .relocate(["CI"], { after: "Percent" })

                                        // .select(aq.not('GeoType', 'Long'))
                                        // .rename({ CI: "95% CL" })
                                        // .pivot(
                                        // { key: d => op.lower(d.key) },
                                        // { value: d => op.sum(d.value) }
                                        // )
                                } else {
                                    // console.log('hi', ful)
                                    aqData = ful
                                        .groupby("Time", "GeoType", "GeoID")
                                        // .impute({ Value: () => "**" })
                                        // .pivot("MeasurementType", "Value")
                                        .orderby(aq.desc('Time'), 'GeoRank')
                                }
                                
                                // console.log('==========================================================================')
                                // console.log('Load Date - aqData', aqData)
                                // aqData.print();
                            })
                        }

                    const loadDisparitiyData = (disparityIndicator, primaryMeasure) => {
                        const disparityIndicatorId = disparityIndicator[0].IndicatorID;
                        const disparityMeasure = disparityIndicator[0];
                        const primaryMeasureTimes = primaryMeasure[0].AvailableTimes;
                        const primaryMeasurementType =  primaryMeasure[0].MeasurementType;
                        // console.log('+++++++++++++++ loadDisparitiyData +++++++++++++++++++++++++')
                        // console.log('primaryMeasureTimes: ',primaryMeasure, primaryMeasureTimes)

                        const aqPrimaryMeasureTimes = aq.from(primaryMeasureTimes)

                        const filteredSecondaryIndicator =  indicators.filter(indicator =>
                            indicator.Measures.some(measure => 
                                measure.MeasureID === 221)
                        )

                        const filteredSecondaryMeasure = filteredSecondaryIndicator[0].Measures.filter(m =>
                            m.MeasureID === 221
                        )

                        const secondaryMeasureTimes = filteredSecondaryMeasure[0].AvailableTimes;
                        const secondaryMeasureGeoTypes = filteredSecondaryMeasure[0].AvailableGeographyTypes;

                        const aqSecondaryMeasureTimes = aq.from(secondaryMeasureTimes)

                        console.log('==== aqSecondaryMeasureTimes ====')
                        aqSecondaryMeasureTimes.print({limit: 100})
                        console.log(aqSecondaryMeasureTimes);

                        fetch(data_repo + "/" + data_branch + `/indicators/data/${disparityIndicatorId}.json`)
                            .then(response => response.json())
                            .then(data => {
                                const povertyData = data.filter(d => d.MeasureID === 221)
                                let primaryTimes = []

                                defaultTrendMeasure[0].AvailableTimes.map(t => primaryTimes.push(`${t.TimeDescription}`) )

                                const filteredDisparityData = aq.from(povertyData)
                                    .join(aqSecondaryMeasureTimes, ["Time", "TimeDescription"])
                                    .derive({
                                        bin: aq.bin('Value', { maxbins: 3 }),
                                    })
                                    .derive({
                                        Tertile: aq.escape( d => d.bin === 0 && 'low' || d.bin === 20 && 'med' || d.bin === 40 && 'hi')
                                    })
                                    .groupby("Tertile")
                                    

                                console.log('DISPARITY - filteredDisparityData ==============================')
                                filteredDisparityData.print({ limit: 10 })

                                const aqJoinedPrimaryMeasureTimes = aq.from(joinedAqData) //joinedAqData //fullDataTrendObjects
                                        .join(aqPrimaryMeasureTimes, ["Time", "TimeDescription"])
                                        
                                        console.log("joinded time ----------- primary")
                                        aqJoinedPrimaryMeasureTimes.print({ limit: 10 })


                                const aqJoinedPrimaryTrendData = aq.from(aqJoinedPrimaryMeasureTimes)
                                        .join(filteredDisparityData, [["end_period", "GeoID"], ["end_period", "GeoID"]])
                                        .select('Time_1', 'Geography', 'GeoType_1', 'Age Adjusted Rate - Total', 'Value', 'Tertile')
                                        .filter(d => d.GeoType_1 !== 'Citywide')

                           
                                        
                                        // .derive({
                                        //     low1: d => d.Value > (d.min + d.bin) && d.Value,
                                        //     medium: d => d.Value < ((d.min + d.bin) && d.Value < (d.max - d.bin)) && d.Value
                                        // })
                                        // .groupby("max", "min", "Value", "bin", "low1", "medium", "Time", "Name", "bin3")

                                        //.join(filteredDisparityData, [["Time", "GeoType", "GeoID"], ["Time", "GeoType", ]])
                                        //.cross(filteredDisparityData)
                                        //.select('Time_1', `${primaryMeasurementType}`, 'Tertile')
                                        //.cross(filteredDisparityData, [[`Time`, `${primaryMeasurementType}`], [`Tertile`, `Tertile Percent`]])
                                        //.groupby("Time_1", "Tertile")
                                        //.groupby("end_period", "GeoID")
                                        //.rename({ 'Age Adjusted Rate - Total': 'Value' })
                                        //.derive({ index: d => op.row_number() - 1 })
                                        //.derive({Median: op.median('Value')})
                               
                                        
                                    // console.log('DISPARITY - aqJoinedPrimaryTrendData ==============================')
                                    // console.log(aqJoinedPrimaryTrendData)
                                    // aqJoinedPrimaryTrendData.print({ limit: 200 })


                                    // const low = aq.from(aqJoinedPrimaryTrendData)
                                    //     .filter(d => d.Tertile === 0)
                                    //     
// 
                                    // const med = aq.from(aqJoinedPrimaryTrendData)
                                    //     .filter(d => d.Tertile === 18)
                                    //     
// 
                                    //     const hi = aq.from(aqJoinedPrimaryTrendData)
                                    //     .filter(d => d.Tertile === 36)
                                    //     
// 
                                    // console.log('low --------------')
                                    // low.print()
                                    // console.log('med --------------')
                                    // med.print()
                                    // console.log('hi --------------')
                                    // hi.print()



                                    

                                    // console.log('aqJoinedPrimaryTrendData', aqJoinedPrimaryTrendData.objects())
                                   
                                        
                                    // aqJoinedPrimaryTrendData.print({ limit: 40 })
                                    // joinedDataTrendDisparityObjects = aqJoinedPrimaryTrendData.objects(); 


                                    const newDisparity = aq.from(aqJoinedPrimaryTrendData)
                                        .groupby("Time_1", "Tertile", "GeoType_1")
                                        .rollup({
                                            median: d => op.median(d["Age Adjusted Rate - Total"])
                                        })
                                        .filter(d => d.GeoType_1 === 'Subboro')

                                    joinedDataTrendDisparityObjects = newDisparity.objects()
                                    console.log('New Disparity Data ==========================')
                                    newDisparity.print({ limit: 60 })
                            })
                    }

                    // returned the array of measure in indicators.json
                    const filterSecondaryIndicatorMeasure = (primaryMeasure) => {
                        // console.log('==========================================================================')
                        // console.log("PRIMARY MEASURE DATA: ", primaryMeasure)
                        const primaryMeasureId = primaryMeasure[0].VisOptions[0].Links[0].MeasureID;
                        const primaryMeasureTimes = primaryMeasure[0].AvailableTimes;
                        const filteredSecondaryIndicator =  indicators.filter(indicator =>
                            indicator.Measures.some(measure => 
                                measure.MeasureID === primaryMeasureId)
                        )

                        const filteredSecondaryMeasure = filteredSecondaryIndicator[0].Measures.filter(m =>
                            m.MeasureID === primaryMeasureId
                        )

                        selectedlinksSecondaryIndicatorData = filteredSecondaryIndicator
                        selectedlinksSecondaryMeasureData = filteredSecondaryMeasure

                        // console.log('PRIMARY MEASURE TIMES: +++++++++++ ', primaryMeasureTimes)
                        // console.log('FILTERED AXIS INDICATOR: --------- ', filteredSecondaryIndicator)
                        // console.log('FILTERED AXIS MEASURE: +++++++++++ ', filteredSecondaryMeasure)

                        const sortedPrimaryMeasureTimes = primaryMeasureTimes.sort((a, b) => b.end_period - a.end_period)
                        const mostRecentPrimaryMeasureTime = sortedPrimaryMeasureTimes[0].TimeDescription;
                        const mostRecentPrimaryMeasureStartTime = sortedPrimaryMeasureTimes[0].start_period;
                        const mostRecentPrimaryMeasureEndTime = sortedPrimaryMeasureTimes[0].end_period;

                        const aqPrimaryMeasureTimes = aq.from(primaryMeasureTimes);

                        // console.log('MOST RECENT PRIMARY MEASURE START + END TIME: -------------- ', mostRecentPrimaryMeasureTime, mostRecentPrimaryMeasureStartTime, mostRecentPrimaryMeasureEndTime)

                        // aqPrimaryMeasureTimes.print()
                        
                        // console.log('most recent mmmm ', aq.from([sortedPrimaryMeasureTimes[0]]))
                        const secondaryMeasureTimes = filteredSecondaryMeasure[0].AvailableTimes;
                        const sortedSecondaryMeasureTimes = secondaryMeasureTimes.sort((a, b) => b.end_period - a.end_period)
                        const mostRecentSecondaryMeasureTime = sortedSecondaryMeasureTimes[0].TimeDescription;
                        const mostRecentSecondaryMeasureStartTime = sortedSecondaryMeasureTimes[0].start_period;
                        const mostRecentSecondaryMeasureEndTime = sortedSecondaryMeasureTimes[0].end_period;

                        const aqSecondaryMeasureTimes = aq.from(secondaryMeasureTimes);
                        


                        const filteredMatchingTimes = sortedSecondaryMeasureTimes.filter(t => 
                            // t.start_period >= mostRecentPrimaryMeasureStartTime && t.end_period <= mostRecentPrimaryMeasureEndTime
                            t.start_period >= 'no' && t.end_period <= 'yes'
                        )

                        if (!filteredMatchingTimes.length) {
                            // console.log('no match')
                            const mostRecentMatchingTime = sortedSecondaryMeasureTimes.filter(t => 
                                t.end_period === mostRecentPrimaryMeasureEndTime
                                // t.start_period >= 'no' && t.end_period <= 'yes'
                            )
                           //  // console.log('~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ most recent mathcing time: ', mostRecentMatchingTime)
                        }

                        // console.log('>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> mathcing times', filteredMatchingTimes)
                        // console.log('SORTED SECONDARY MEASURE TIMES: ', sortedSecondaryMeasureTimes )
                        // console.log('MOST RECENT SECONDARY MEASURE START + END TIME: -------------- ', mostRecentSecondaryMeasureTime, mostRecentSecondaryMeasureStartTime, mostRecentSecondaryMeasureEndTime)

                        const filteredSecondaryIndicatorId = filteredSecondaryIndicator[0].IndicatorID;
                            const sortedPrimaryT = aq.from(sortedPrimaryMeasureTimes)

                        fetch(data_repo + "/" + data_branch + `/indicators/data/${filteredSecondaryIndicatorId}.json`)
                            .then(response => response.json())
                            .then(data => {
                                
                                const filteredSecondaryMeasureData = data.filter(d => d.MeasureID === primaryMeasureId)
                                // console.log('data: -----------------------------------> ', filteredSecondaryMeasureData)
                                // console.log('SORTED SECONDARY MEASURE TIMES ', sortedSecondaryMeasureTimes)

                                // const testData = aq.from(fullDataLinksObjects)
                                //     .join(sortedSecondaryT, ["Time", "TimeDescription"])
                                //     .filter(d => d.Time === '2007-2011')
                                const aqJoinedSecondaryLinksData = aq.from(filteredSecondaryMeasureData)
                                    .groupby("Time", "GeoType", "GeoID", 'MeasureID')
                                    .pivot("MeasurementType", "Value")
                                    .join(geoTable, [["GeoID", "GeoType"], ["GeoID", "GeoType"]])
                                    .join(aqSecondaryMeasureTimes, ["Time", "TimeDescription"])
                                    .relocate(['Name'], { after: 'GeoID' })
                                    .relocate(['GeoType'], { before: 'GeoID' })
                                    .rename({
                                        'Name': 'Geography',
                                    })
                                    
                                    
                                    // .filter(d => op.parse_int(d.Time) >= 2007 && op.parse_int(d.Time) === 2011)
                                    // .join(testData, [["GeoID", "GeoType"], ["GeoID", "GeoType"]])
                                    
                                    // aq.from(fullDataLinksObjects).filter(d => d.Time === '2007-2011').print()
                                    // console.log('^^^^^^^^^^^^^^^^^ full data ^^^^^^^^^^^^^^^^^^^^^^^^', fullDataLinksObjects)


                                const  aqJoinedPrimaryLinksData = aq.from(fullDataLinksObjects)
                                    .join(aqPrimaryMeasureTimes, ["Time", "TimeDescription"])

                                // console.log('@@@@@@@@@@@@@@@@@@@@ AQ PRIMARY DATA @@@@@@@@@@@@@@@@@@@@@@@@@ ' )
                                // aqJoinedPrimaryLinksData.print()

                                const joinedPrimaryLinksDataObject = aqJoinedPrimaryLinksData.objects();
                                const filteredJoinedPrimaryLinksDataObject = joinedPrimaryLinksDataObject.filter(d => 
                                    d.start_period == mostRecentPrimaryMeasureStartTime && d.end_period == mostRecentPrimaryMeasureEndTime)

                                const joinedSecondaryLinksDataObject = aqJoinedSecondaryLinksData.objects();

                                let mostRecentJoinedSecondaryLinksDataObject = []

                                

                                // get the closest secondary end time 
                                const closestSecondaryTime = joinedSecondaryLinksDataObject.reduce((prev, curr) => {
                                    return (Math.abs(curr.end_period - mostRecentPrimaryMeasureEndTime) < Math.abs(prev.end_period - mostRecentPrimaryMeasureEndTime) ? curr : prev);
                                });

                                

                                const closestSecondaryData = joinedSecondaryLinksDataObject.filter(d => 
                                    d.end_period === closestSecondaryTime.end_period)

                                mostRecentJoinedSecondaryLinksDataObject = closestSecondaryData

                                console.log('yo', joinedSecondaryLinksDataObject)

                                const secondaryYears =  [...new Set(mostRecentJoinedSecondaryLinksDataObject.map(item => item.Time))];
                                const highest = Math.max(...secondaryYears);

                                // get lowest number
                                const lowest = Math.min(...secondaryYears);

                                if (secondaryYears.length > 1) {
                                    selectedlinksSecondaryMeasureTime = `${lowest}-${highest}`;
                                } else {
                                    selectedlinksSecondaryMeasureTime = `${secondaryYears[0]}`
                                }
                                
                                // console.log('%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% SEONDARY YEARS', secondaryYears, highest, lowest)


                                const aqMostRecentJoinedSecondaryLinksDataObject = aq.from(mostRecentJoinedSecondaryLinksDataObject)

                                const aqJoinedPrimarySecondaryData = aq.from(filteredJoinedPrimaryLinksDataObject)
                                    .join(aqMostRecentJoinedSecondaryLinksDataObject, [["GeoID", "GeoType"], ["GeoID", "GeoType"]])
                                
                                // aqJoinedPrimarySecondaryData.print()
                                joinedDataLinksObjects = aqJoinedPrimarySecondaryData.objects();

                                // console.log('==========================================================================')
                                // console.log('Load Date - aqJoinedSecondaryLinksData')
                                // aq.from(mostRecentJoinedSecondaryLinksDataObject).print();
                            })
                    }

                    const handleYearFilter = (el, indicatorId) => {
                        el.addEventListener('change',(e) => {
                            if (e.target.checked) {
                                // console.log('checked')
                                selectedSummaryYears = [e.target.value]
                            }
                            renderTable()
                        })
                    }

                    const handleGeoFilter = (el, indicatorId) => {
                        el.addEventListener('change',(e) => {
                            if (e.target.checked) {
                                selectedSummaryGeography.push(e.target.value)
                            } else {
                                selectedSummaryGeography = selectedSummaryGeography.filter(item => item !== e.target.value);
                            }
                            renderTable()
                        })
                    }

                    const handleToggle = () => { 
                        $('body').off('click', '#summary-table tr.group td');
                        $('body').on('click', '#summary-table tr.group td', (e) => {
                            const td = $(e.target);
                            const tr = td.parent();
                            const group = td.data('group');
                            const groupLevel = td.data('group-level');

                            const handleGroupToggle = () => {
                                
                                const subGroupToggle = $(`td[data-year="${group}"][data-group-level="1"]`);
                                const subGroupRow = $(`tr[data-year="${group}"]`);

                                if (subGroupToggle.css('display') === 'none') {
                                    subGroupToggle.removeClass('hidden');
                                    subGroupRow.removeClass('hidden');
                                    td.removeClass('hidden');
                                    subGroupToggle.show();
                                    subGroupRow.show();
                                } else {
                                    subGroupToggle.addClass('hidden');
                                    subGroupRow.addClass('hidden');
                                    td.addClass('hidden');
                                    subGroupToggle.hide();
                                    subGroupRow.hide();
                                }
                            }

                            const handleSubGroupToggle = () => {
                                const subDataGroup = tr.next(`tr`).data(`group`);
                                const parentDataGroup = subDataGroup.split('-')[0];
                                const subGroupRow = $(`tr[data-group="${subDataGroup}"]`);
                                const parentGroupToggle = $(`td[data-group="${parentDataGroup}"]`);

                                if (subGroupRow.css('display') == 'none')  {
                                    subGroupRow.show();
                                    td.removeClass('hidden');
                                    subGroupRow.removeClass('hidden');
                                    parentGroupToggle.removeClass('hidden');
                                } else {
                                    subGroupRow.hide();
                                    td.addClass('hidden');
                                    subGroupRow.addClass('hidden');
                                }
                            }

                            if (groupLevel === 0) {
                                handleGroupToggle();
                            } else {
                                handleSubGroupToggle();
                            }

                        });
                    }

                    // Renders the Indicator Title and Description
                    const renderTitleDescription = (title, desc) => {
                        const indicatorTitle = document.querySelector('.indicator-title');
                        const indicatorDescription = document.querySelector('.indicator-description');
                        indicatorTitle.innerHTML = title;
                        indicatorDescription.innerHTML = `${desc}`;
                    }

                    // Renders copy for the About the measures and the Data sources sections
                    const renderAboutSources = (about, sources) => {
                        aboutMeasures.innerHTML = about;
                        dataSources.innerHTML = sources;
                    }

                    const updateMapData = (e) => {
                        const measureId = parseInt(e.target.dataset.id);
                        const measure = mapMeasures.filter(m => m.MeasureID == measureId);
                        const measurementType = measure[0].MeasurementType;
                        const date = e.target.dataset.date;
                        const about = measure[0].how_calculated;
                        const sources = measure[0].Sources;
                        const display = measure[0].DisplayType;

                        selectedMapAbout = about;
                        selectedMapSources =  sources;

                        selectedMapSources = `<h6>${indicator.IndicatorName} - ${measurementType}</h6><p>${sources}</p>`;
                        selectedTrendAbout = `<h6>${indicator.IndicatorName} - ${measurementType}</h6><p>${about}</p>`;
                        
                        var geoTypFilteredData;
                        
                        const filteredData = fullDataMapObjects.filter(obj => 
                            obj.Time === date
                        )

                        renderAboutSources(selectedTrendAbout, selectedMapSources);
                        renderMap(filteredData, measurementType, display, date);
                        selectedMapMeasure =  true;
                    }

                    const updateTrendData = (e) => {
                        const measureId = parseInt(e.target.dataset.id);
                        const measure = trendMeasures.filter(m => m.MeasureID == measureId);
                        const measurementType = measure[0].MeasurementType;
                        const disparities = measure[0].VisOptions[0].Trend && measure[0].VisOptions[0].Trend[0]?.Disparities;
                        const about = measure[0].how_calculated;
                        const sources = measure[0].Sources;
                        const display = measure[0].DisplayType;

                        selectedTrendSources = `<h6>${indicator.IndicatorName} - ${measurementType}</h6><p>${sources}</p>`;
                        selectedTrendAbout = `<h6>${indicator.IndicatorName} - ${measurementType}</h6><p>${about}</p>`;
                        
                        renderAboutSources(selectedTrendAbout, selectedTrendSources);
                        renderTrendChart(fullDataTrendObjects, measurementType, display, disparities, measure);
                        selectedTrendMeasure = true;
                    }

                    const updateLinksData = (e) => {
                        const measureId = parseInt(e.target.dataset.measureId);
                        const primaryMeasureId = parseInt(e.target.dataset.primaryMeasureId);
                        const secondaryMeasureId = parseInt(e.target.dataset.secondaryMeasureId);

                        const linksSecondaryIndicator =  indicators.filter(indicator =>
                            indicator.Measures.some(m => 
                                m.MeasureID === secondaryMeasureId)
                        )
                        const linksSecondaryMeasure = linksSecondaryIndicator[0].Measures.filter(m =>
                            m.MeasureID === secondaryMeasureId
                        )

                        const measure = linksMeasures.filter(m => m.MeasureID == measureId);
                        const measurementType = measure[0].MeasurementType;
                        const secondaryMeasure = linksSecondaryMeasure[0].MeasurementType;
                        const secondaryIndicator = linksSecondaryIndicator[0].IndicatorLabel;
                        
                        const axis = measure[0].VisOptions[0].Links.filter(d => d.MeasureID === secondaryMeasureId)[0].Axis

                        console.log('AXIS: ', primaryMeasureId, secondaryMeasureId, measure[0], axis)
                        
                        
                        const about = measure[0].how_calculated;
                        const secondaryAbout = linksSecondaryMeasure[0].how_calculated;
                        const sources = measure[0].Sources;
                        const secondarySources = linksSecondaryMeasure[0].Sources;
                        const display = measure[0].DisplayType;
                        const combinedSources = `<h6>${indicator.IndicatorName} - ${measurementType}</h6><p>${sources}</p><h6>${secondaryIndicator} - ${secondaryMeasure}</h6><p>${secondarySources}</p>`;
                        const combinedAbout = `<h6>${indicator.IndicatorName} - ${measurementType}</h6><p>${about}</p><h6>${secondaryIndicator} - ${secondaryMeasure}</h6><p>${secondaryAbout}</p>`;
                        
                        selectedLinkMeasureData = linksMeasures.filter(m => m.MeasureID === measureId)
                        // console.log('LINKS MEASURES: ', selectedLinkMeasureData, primaryMeasureId, linksSecondaryIndicator)
                        selectedLinksAbout = combinedAbout;
                        selectedLinksSources =  combinedSources;


                        // console.log('fix linksSecondaryIndicator: ', linksSecondaryIndicator)
                        // console.log('fix linksSecondaryMeasure: ', linksSecondaryMeasure)
                        // console.log('fix selectedLinkMeasureData', selectedLinkMeasureData)
                        
                        renderAboutSources(combinedAbout, combinedSources);
                        renderLinksChart(selectedLinkMeasureData, measurementType, display, axis, measureId, secondaryMeasureId)
                        selectedLinksMeasure = true;
                    }

                    const setDefaultMapMeasure = (defaultArray, visArray) => {
                        // console.log('SET DEFAULT MEASURE: ', mapMeasures, trendMeasures, defaultArray)
                        defaultArray.length = 0;

                        const hasAgeAdjustedRate = visArray.filter(measure =>
                            measure.MeasurementType.includes('Age Adjusted Rate')
                        )
                        const hasRate = visArray.filter(measure =>
                            measure.MeasurementType.includes('Rate')
                        )
                        const hasPercent = visArray.filter(measure =>
                            measure.MeasurementType.includes('Percent')
                        )

                        if (hasAgeAdjustedRate.length) {
                            const hasAgeAdjustedRateTotal = hasAgeAdjustedRate.filter(measure => 
                                measure.MeasurementType.includes('Total')
                            )

                            // Set total as default if available
                            if (hasAgeAdjustedRateTotal.length) {
                                defaultArray.push(hasAgeAdjustedRateTotal[0]);
                            } else {
                                defaultArray.push(hasAgeAdjustedRate[0]);
                            }
                            
                        } else if (hasRate.length) {
                            defaultArray.push(hasRate[0]);
                        } else if (hasPercent.length) {
                            defaultArray.push(hasPercent[0]);
                        } else {
                            defaultArray.push(visArray[0]);
                        }
                    }

                    const setDefaultMeasure = (defaultArray, visArray) => {
                        defaultArray.length = 0;

                        if (visArray.length > 0) {
                            const hasAgeAdjustedRate = visArray.filter(measure =>
                                measure.MeasurementType.includes('Age Adjusted Rate')
                            )
                            const hasRate = visArray.filter(measure =>
                                measure.MeasurementType.includes('Rate')
                            )
                            const hasPercent = visArray.filter(measure =>
                                measure.MeasurementType.includes('Percent')
                            )

                            if (hasAgeAdjustedRate.length) {
                                const hasAgeAdjustedRateTotal = hasAgeAdjustedRate.filter(measure => 
                                    measure.MeasurementType.includes('Total')
                                )
                                // Set total as default if available
                                if (hasAgeAdjustedRateTotal.length) {
                                    defaultArray.push(hasAgeAdjustedRateTotal[0]);
                                } else {
                                    defaultArray.push(hasAgeAdjustedRate[0]);
                                }
                                
                            } else if (hasRate.length) {
                                defaultArray.push(hasRate[0]);
                            } else if (hasPercent.length) {
                                defaultArray.push(hasPercent[0]);
                            } else {
                                defaultArray.push(visArray[0]);
                            }
                        }                        
                    }

                    const setDefaultLinksMeasure = (defaultArray, visArray) => {
                        defaultArray.length = 0;

                        if (visArray.length > 0) {
                            const hasAgeAdjustedRate = visArray.filter(measure =>
                                measure.MeasurementType.includes('Age Adjusted Rate')
                            )
                            const hasRate = visArray.filter(measure =>
                                measure.MeasurementType.includes('Rate')
                            )
                            const hasPercent = visArray.filter(measure =>
                                measure.MeasurementType.includes('Percent')
                            )

                            if (hasAgeAdjustedRate.length) {
                                const hasAgeAdjustedRateTotal = hasAgeAdjustedRate.filter(measure => 
                                    measure.MeasurementType.includes('Total')
                                )
                                // Set total as default if available
                                if (hasAgeAdjustedRateTotal.length) {
                                    defaultArray.push(hasAgeAdjustedRateTotal[0]);
                                } else {
                                    defaultArray.push(hasAgeAdjustedRate[0]);
                                }
                                
                            } else if (hasRate.length) {
                                defaultArray.push(hasRate[0]);
                            } else if (hasPercent.length) {
                                defaultArray.push(hasPercent[0]);
                            } else {
                                defaultArray.push(visArray[0]);
                            }
                            defaultLinkMeasureTimes = defaultArray[0].AvailableTime;
                            const defaultArrayMeasureId = defaultArray[0].VisOptions[0].Links[0].MeasureID;
                            filterSecondaryIndicatorMeasure(defaultArray)
                        }
                    }
                    
                    const loadIndicator = (data, bypassUrlChange) => {
                        let data2 = data
                        selectedSummaryYears = [];
                        selectedSummaryGeography = [];
                        const firstIndicatorId = document.querySelectorAll('#indicator-dropdown button')[0].getAttribute('data-internal-id');
                        if (!data2) { 
                            data2 = defaultIndicatorId
                        }
        
                        indicator = indicators.find(indicator => indicator.IndicatorID === data2);
                        indicatorName = indicator?.IndicatorName ? indicator.IndicatorName : 'N/A';
                        indicatorDesc = indicator?.IndicatorDescription ? indicator.IndicatorDescription : `N/A`;
                        indicatorShortName = indicator?.IndicatorShortname ? indicator.IndicatorShortname : indicatorName;
                        indicatorMeasurses = indicator?.Measures;
                        indicatorId = indicator?.IndicatorID;     

                        //create Citation
                        createCitation(); // re-runs on updating Indicator

                        // send Indicator Title to vis headers
                        document.getElementById('summaryTitle').innerHTML = indicatorName;
                        document.getElementById('mapTitle').innerHTML = indicatorName;
                        document.getElementById('trendTitle').innerHTML = indicatorName;
                        document.getElementById('linksTitle').innerHTML = indicatorName;
                        
                        // console.log('==========================================================================')
                        // console.log('Load Indicator - IndicatorId: ', indicatorId)
                        // console.log('Load Indicator - Description: ', indicatorDesc)
                        // console.log('Load Indicator - Indicator: ', indicator)
                        // console.log('Load Indicator - Measures: ', indicatorMeasurses)


                        if (!bypassUrlChange) {
                            url.searchParams.set('id', indicatorId);
                            window.history.pushState({ id: indicatorId }, '', url);
                        }
                        

                        loadData(indicatorId)
                        const indicatorTitle = document.querySelector(".indicator-title")
                        indicatorTitle.innerHTML = indicatorName
                    }

                    const renderMeasures = () => {
                        // console.log('==========================================================================')
                        // console.log('Render Measures')
                        linksMeasures.length = 0

                        const contentSummary = document.querySelector('#tab-table');
                        const contentMap = document.querySelector('#tab-map')
                        const contentTrend = document.querySelector('#tab-trend');
                        const contentLinks = document.querySelector('#tab-links');
                        const dropdownTableYear = contentSummary.querySelector('div[aria-labelledby="dropdownTableYear"]');
                        const dropdownMapMeasures = document.querySelector('div[aria-labelledby="dropdownMapMeasures"]');                        
                        
                        const dropdownMapYear = contentMap.querySelector('div[aria-labelledby="dropdownMapYear"]');
                        const dropdownTableGeo = contentSummary.querySelector('div[aria-labelledby="dropdownTableGeo"]');
                        const dropdownTrendMeasures = contentTrend.querySelector('div[aria-labelledby="dropdownTrendMeasures"]');
                        const dropdownLinksMeasures = contentLinks.querySelector('div[aria-labelledby="dropdownLinksMeasures"]');
                        const tableGeoTypes =  [...new Set(joinedAqData.objects().map(item => item.GeoType))];
                        const tableYears =  [...new Set(joinedAqData.objects().map(item => item.Time))];
                        const mapYears =  [...new Set(fullDataMapObjects.map(item => item.Time))];

                        // clear Measure Dropdowns
                        dropdownTableYear.innerHTML = ``;
                        dropdownTableGeo.innerHTML = ``;
                        dropdownMapMeasures.innerHTML = ``;
                        dropdownTrendMeasures.innerHTML = ``;
                        dropdownLinksMeasures.innerHTML = ``;

                        mapMeasures.length = 0;
                        trendMeasures.length = 0;

                        tableYears.forEach((year, index) => {
                            if (index === 0) {
                                selectedSummaryYears.push(year);
                                dropdownTableYear.innerHTML += `<label class="dropdown-item checkbox-year"><input type="radio" name="year" value="${year}" checked /> ${year}</label>`;
                            } else {
                                dropdownTableYear.innerHTML += `<label class="dropdown-item checkbox-year"><input type="radio" name="year" value="${year}" /> ${year}</label>`;
                            }
                        });

                        tableGeoTypes.forEach((geoType, index) => {
                            selectedSummaryGeography.push(geoType);
                            dropdownTableGeo.innerHTML += `<label class="dropdown-item checkbox-geo"><input type="checkbox" value="${geoType}" checked /> ${geoType}</label>`;
                        });

                        // console.log('measures: ', indicator, indicatorMeasurses)

                        indicatorMeasurses.map((measure, index) => {
                            const type = measure?.MeasurementType;
                            const displayType = measure?.DisplayType;
                            const years = measure?.AvailableTimes.sort((a, b) => b.start_period - a.start_period);
                            const geography = measure?.AvailableGeographyTypes;
                            const links = measure?.VisOptions[0].Links && measure?.VisOptions[0]?.Links[0];
                            const map = measure?.VisOptions[0].Map && measure?.VisOptions[0].Map[0]?.On;
                            const trend = measure?.VisOptions[0].Trend && measure?.VisOptions[0].Trend[0]?.On;
                            const trendDisparities = measure?.VisOptions[0].Trend && measure?.VisOptions[0].Trend[0]?.Disparities;
                            const about = measure.how_calculated;
                            const sources = measure.Sources;
                            const measureId = measure.MeasureID;

                            if (map === 1) {
                                mapMeasures.push(measure)
                                dropdownMapMeasures.innerHTML += `<div class="dropdown-column-${index}"><div class="dropdown-title"><strong> ${type}</strong></div></div>`;
                                const dropdownMapMeasuresColumn = document.querySelector(`.dropdown-column-${index}`);
                                // console.log('dropdownMapMeasures: ', dropdownMapMeasures)
                                mapYears.map((time, index) => {
                                    dropdownMapMeasuresColumn.innerHTML += `<button class="dropdown-item link-measure"
                                        data-id="${measureId}"
                                        data-date="${time}">
                                            ${time}
                                        </button>`;
                                })
                            }

                            if (trend === 1) {
                                trendMeasures.push(measure)
                                if  (fullDataTrendObjects) {
                                    dropdownTrendMeasures.innerHTML += `<button class="dropdown-item link-measure"
                                        data-id="${measureId}"> 
                                            ${type}
                                        </button>`;
                                }
                            }

                            if (links) {
                                linksMeasures.push(measure)
                                const primaryMeasureId = measure.VisOptions[0].Links[0].MeasureID;

                                if  (fullDataLinksObjects) {
                                    const linkYears =  [...new Set(fullDataLinksObjects.map(item => item.Time))];
                                    dropdownLinksMeasures.innerHTML += `<div class="dropdown-title"><strong> ${type}</strong></div>`;
                                    measure.VisOptions[0].Links.map(link => {
                                        const linksSecondaryIndicator = indicators.filter(indicator =>
                                            indicator.Measures.some(m => 
                                                m.MeasureID === link.MeasureID)
                                        );

                                        const linksSecondaryMeasure = linksSecondaryIndicator[0].Measures.filter(
                                            m => m.MeasureID === link.MeasureID
                                        );

                                        dropdownLinksMeasures.innerHTML += `<button class="dropdown-item link-measure" 
                                            data-primary-measure-id="${primaryMeasureId}"
                                            data-measure-id="${measure.MeasureID}"
                                            data-secondary-measure-id="${link.MeasureID}">
                                               ${linksSecondaryIndicator[0].IndicatorLabel} - ${linksSecondaryMeasure[0].MeasurementType}
                                            </button>`;
                                    })
                                }
                            }
                        })

                        setDefaultMapMeasure(defaultMapMeasure, mapMeasures);
                        setDefaultMeasure(defaultTrendMeasure, trendMeasures);
                        setDefaultLinksMeasure(defaultLinksMeasure, linksMeasures);

                        $('#tab-btn-table').on('shown.bs.tab', function(e){
                            $($.fn.dataTable.tables(true)).DataTable()
                                .columns.adjust();
                            renderAboutSources(measureAbout, measureSources)
                            window.location.hash = 'display=summary'
                            updateChartPlotSize();
                        });

                        $('#tab-btn-map').on('shown.bs.tab', function(e){
                            $($.fn.dataTable.tables(true)).DataTable()
                                .columns.adjust();
                            window.location.hash = 'display=map'
                            updateChartPlotSize();
                            if (!selectedMapMeasure) {
                                const about = defaultMapMeasure[0]?.how_calculated;
                                const sources = defaultMapMeasure[0].Sources;
                                const measure = defaultMapMeasure[0].MeasurementType;
                                defaultMapbout = `<h6>${indicator.IndicatorName} - ${measure}</h6><p>${about}</p>`;
                                defaultMapSources = `<h6>${indicator.IndicatorName} - ${measure}</h6><p>${sources}</p>`;
                                renderAboutSources(defaultMapAbout, defaultMapSources);
                            } else {
                                renderAboutSources(selectedMapAbout, selectedMapSources);
                            }
                        });

                        $('#tab-btn-trend').on('shown.bs.tab', function(e){
                            $($.fn.dataTable.tables(true)).DataTable()
                                .columns.adjust();
                            renderAboutSources(measureAbout, measureSources);
                            window.location.hash = 'display=trend';
                            updateChartPlotSize();
                            if (!selectedTrendMeasure) {
                                const about = defaultTrendMeasure[0]?.how_calculated;
                                const sources = defaultTrendMeasure[0].Sources;
                                const measure = defaultTrendMeasure[0].MeasurementType;
                                defaultTrendAbout = `<h6>${indicator.IndicatorName} - ${measure}</h6><p>${about}</p>`;
                                defaultTrendSources = `<h6>${indicator.IndicatorName} - ${measure}</h6><p>${sources}</p>`;
                                renderAboutSources(defaultTrendAbout, defaultTrendSources);
                            } else {
                                renderAboutSources(selectedTrendAbout, selectedTrendSources);
                            }
                        });

                        $('#tab-btn-links').on('shown.bs.tab', function(e){
                            $($.fn.dataTable.tables(true)).DataTable()
                                .columns.adjust();
                            window.location.hash = 'display=links';
                            updateChartPlotSize();

                            const primaryMeasureId = defaultLinksMeasure[0]?.VisOptions[0].Links[0].MeasureID;
                            const linksSecondaryIndicator =  indicators.filter(indicator =>
                                indicator.Measures.some(m => 
                                    m.MeasureID === primaryMeasureId)
                            )

                            const linksSecondaryMeasure = linksSecondaryIndicator[0].Measures.filter(m =>
                                m.MeasureID === primaryMeasureId
                            )
                            const primaryIndicator = indicator.IndicatorName;
                            const primaryMeasure = defaultLinksMeasure[0].MeasurementType;
                            const primaryAbout = defaultLinksMeasure[0].how_calculated;
                            const primarySources = defaultLinksMeasure[0].Sources;
                            const secondaryIndicator = linksSecondaryIndicator[0].IndicatorLabel;
                            const secondaryMeasure = linksSecondaryMeasure[0].MeasurementType;
                            const secondaryAbout = linksSecondaryMeasure[0].how_calculated;
                            const secondarySources = linksSecondaryMeasure[0].Sources;

                            defaultLinksAbout = `<h6>${primaryIndicator} - ${primaryMeasure}</h6><p>${primaryAbout}</p><h6>${secondaryIndicator} - ${secondaryMeasure}</h6><p>${secondaryAbout}</p>`;
                            defaultLinksSources = `<h6>${primaryIndicator} - ${primaryMeasure}</h6><p>${primarySources}</p><h6>${secondaryIndicator} - ${secondaryMeasure}</h6><p>${secondarySources}</p>`;
                            if (!selectedLinksMeasure) {
                                renderAboutSources(defaultLinksAbout, defaultLinksSources);
                            } else {
                                renderAboutSources(selectedLinksAbout, selectedLinksSources);
                            }
                        });
                        // disable tabs if there are no measures

                        const tabMapSelected = tabMap.getAttribute('aria-selected');
                        const tabTrendSelected = tabTrend.getAttribute('aria-selected');
                        const tabLinksSelected = tabLinks.getAttribute('aria-selected');

                        const disableLink = (el) => {
                            el.classList.add('disabled');
                            el.setAttribute('aria-disabled', true);
                        }

                        const enableLink = (el) => {
                            el.classList.remove('disabled');
                            el.setAttribute('aria-disabled', false);
                        }

                        if (mapMeasures.length === 0) {
                            disableLink(tabMap);
                            if (tabMapSelected === true && currentHash === 'display=map') {
                                // console.log('crack')
                                $('#tab-btn-table').tab('show');
                            }
                        } else {
                            enableLink(tabMap);
                            renderMap();
                        }

                        if (trendMeasures.length === 0) {
                            disableLink(tabTrend);
                            if (tabTrendSelected === true && currentHash === 'display=trend') {
                                $('#tab-btn-table').tab('show');
                            }
                        } else {
                            enableLink(tabTrend);
                            renderTrendChart();
                        }

                        if (linksMeasures.length === 0) {
                            disableLink(tabLinks);
                            if (tabLinksSelected && currentHash === 'display=links') {
                                $('#tab-btn-table').tab('show');
                            }
                        } else {
                            enableLink(tabLinks);
                            renderLinksChart();
                        }
                        renderTable();
                        renderTitleDescription(indicatorShortName, indicatorDesc);
                        renderAboutSources(measureAbout, measureSources);

                        const mapMeasuresLinks = document.querySelectorAll('#tab-map .link-measure');
                        const trendMeasuresLinks = document.querySelectorAll('#tab-trend .link-measure');
                        const linksMeasuresLinks = document.querySelectorAll('#tab-links .link-measure');

                        mapMeasuresLinks.forEach(link => {
                            link.addEventListener('click', e => updateMapData(e));
                        })
                        
                        trendMeasuresLinks.forEach(link => {
                            link.addEventListener('click', e => updateTrendData(e));
                        })

                        linksMeasuresLinks.forEach(link => {
                            link.addEventListener('click', e => updateLinksData(e));
                        })
                        

                        const checkboxYear = document.querySelectorAll('.checkbox-year');
                        const checkboxGeo = document.querySelectorAll('.checkbox-geo');

                        checkboxYear.forEach(checkbox => {
                            handleYearFilter(checkbox, indicatorId);
                        })
                        checkboxGeo.forEach(checkbox => {
                            handleGeoFilter(checkbox, indicatorId);
                        })

                        // Render default Measure About and Sources
                        measureAbout = '';
                        measureSources = '';
                        indicatorMeasurses.map(measure => {
                            measureAbout += `<h6>${measure.MeasurementType}</h6>${measure.how_calculated}`;
                            measureSources += `<h6>${measure.MeasurementType}</h6><p>${measure.Sources}</p>`;
                        })
                        
                        renderAboutSources(measureAbout, measureSources);
                    }
            </script>

            <style>

                .topic-text h3 {
                font-size: 18px;
                color: #656565;
            }
                .topic-text p li {
                font-size: 12px;
            }

            
            </style>

            <div class="row">
                <div class="col-md-4">
                    <div class="card content-card mb-4 d-none d-md-block">
                        <div class="card-content">
                            <div class="card-body fs-sm">
                                <span class='home-label mb-2'>About this topic</span>
                                <div class="topic-text">
                                    <p>Sugary drinks contribute to a higher-calorie diet, long-term weight gain, and increased risk of heart disease and diabetes. Sugary drinks provide little or no nutritional value, and because they dont fill you up the way food does, you end up consuming more calories. Also, food and beverage portion sizes have exploded over the past several decades, and studies have shown that when given larger portions, people consume more without recognizing it.</p>
<h3 id="sugary-drinks-and-health">Sugary Drinks and Health</h3>
<p>Obesity is at epidemic proportions in New York City. More than half of New York City adults (58%) are overweight or obese; nearly 40% of New York Citys public school students (K-8) are obese or overweight; and the percentage of adults with diagnosed diabetes is increasing, with nearly 10% of New Yorkers now diagnosed with diabetes.</p>
<h3 id="about-the-data-and-indicators">About the Data and Indicators</h3>
<p>Sugary drink consumption indicators presented on this site are derived from the annual NYC Youth Risk Behavior Surveys and the Community Health Surveys. They are estimates that depend on study participants&rsquo; accurate recollections and reporting.</p>
<h3 id="prevention">Prevention</h3>
<p>Make healthier choices:</p>
<ul>
<li>Drink plenty of water; nothing quenches thirst better than water.</li>
<li>Choose fat-free or 1% milk.</li>
<li>Switch from juice to whole fruit; whole fruit has fewer calories, and unlike juice, it has fiber.</li>
<li>Skip sports drinks and energy drinks; most are high in sugar and low in nutrients, and energy drinks are loaded with caffeine.</li>
<li>Pass on the high-calorie sweetened coffee and tea drinks; instead, order your coffee or tea plain and lightly flavor it yourself.</li>
<li>Choose smaller portions.</li>
</ul>
<h3 id="key-messages">Key Messages</h3>
<p>Sugary drinks are a major contributor to obesity  and obesity is a risk factor for heart disease and diabetes.</p>
<p>Residents of poor neighborhoods consume more sugary drinks than residents of wealthier neighborhoods.</p>
<p>There are numerous healthy alternatives to sugary drinks, such as water, seltzer, fat-free or 1% milk, and unsweetened tea.</p>

                                </div>

                          </div>
                        </div>
                      </div>


                </div>

                <div class="col-md-8">
                    
                    <button class="btn btn-sm btn-outline-light text-primary btn-block d-block d-md-none mt-0 mb-2" type="button" data-toggle="modal" data-target="#aboutModal">
                        About Sugary Drink Consumption
                      </button>

                    
                    <div class="dropdown float-right">
                        <span class='home-label d-block'>Change dataset</span>

                        <button class="btn btn-outline-primary float-right dropdown-toggle" type="button" id="dropdownTableYear" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="text-align:right!important">
                          More Sugary Drink Consumption data
                        </button>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownTableYear" id="indicator-dropdown">
                            
                        </div>
                    </div>
                    <span class="home-label d-block">Dataset</span>
                    <h3 class="indicator-title"></h3>


                    <div style="clear:both" class="my-2">
                        <span class="home-label d-block">Description</span>

                        <p class="fs-sm indicator-description"></p>
                    </div>

                    <div class="nav nav-pills bg-white device-xs" role="tablist">

                        <a class="nav-item nav-link flex-fill active" id="tab-btn-table" href="#tab-table"
                            data-toggle="pill" aria-controls="tab-table" aria-selected="true" role="tab">
                            <i class="fas fa-list h4 fa-fw"></i><div class="d-none d-lg-block">Summary</div>
                        </a>
                    
                        <a class="nav-item nav-link flex-fill" id="tab-btn-map" href="#tab-map"
                            data-toggle="pill" aria-controls="tab-map" aria-selected="false" role="tab">
                            <i class="fas fa-map-marker-alt h4 fa-fw"></i><div class="d-none d-lg-block">Map</div>
                        </a>
                    
                        <a class="nav-item nav-link flex-fill" id="tab-btn-trend" href="#tab-trend"
                            data-toggle="pill" aria-controls="tab-trend" aria-selected="false" role="tab">
                            <i class="fas fa-chart-line h4 fa-fw"></i><div class="d-none d-lg-block">Trend</div>
                        </a>


                        <a class="nav-item nav-link flex-fill" id="tab-btn-links" href="#tab-links"
                            data-toggle="pill" aria-controls="tab-links" aria-selected="false" aria-disabled="true" role="tab">
                            <i class="fas fa-link h4 fa-fw"></i><div class="d-none d-lg-block">Links</div>
                        </a>
                    
                    </div>
                    
                    <div class="tab-content bg-white mb-4" id="tabs-01-content">
                        
                        <div class="tab-pane fade show active py-2" id="tab-table" aria-labelledby="tab-btn-table" role="tabpanel">
                            <div class="float right">
                                <div class="dropdown">
                                    <button class="btn btn-sm float-right btn-outline-success dropdown-toggle" type="button" id="dropdownTableYear" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Select year
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="dropdownTableYear">
                                        
                                    </div>
                                </div>

                                <div class="dropdown">
                                    <button class="btn btn-sm mr-1 float-right btn-outline-success dropdown-toggle" type="button" id="dropdownTableGeo" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Select geography
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="dropdownTableGeo">
                                        
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <span id="summaryTitle" class="home-label"></span>
                                <div id="summary-table">
                                    
                            </div>

                            </div>
                        </div> 
                        
                        <div class="tab-pane fade py-2" id="tab-map" aria-labelledby="tab-btn-map" role="tabpanel">
                            <div class="float right">
                                <div class="dropdown">
                                    <button class="btn btn-sm mr-1 float-right btn-outline-success dropdown-toggle" type="button" id="dropdownMapMeasures" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Select measure
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="dropdownMapMeasures">
                                        
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <span id="mapTitle" class="home-label"></span>
                                <div id="map" width=600 height=500 style="width: 100%; min-height: 450px; margin-bottom: 50px;"></div>
                            </div>                        
                        </div>
                        
                        <div class="tab-pane fade py-2" id="tab-trend" aria-labelledby="tab-btn-trend" role="tabpanel">
                            <div class="dropdown float-right">
                                <button class="btn btn-sm float-right btn-outline-success dropdown-toggle" type="button" id="dropdownTrendMeasures" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Choose measure
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownTrendMeasures">
                                  
                                </div>
                            </div>
                            <div class="mt-4">
                                <span id="trendTitle" class="home-label"></span>
                                
                                <div id="trend" style="width: 100%"></div>
                            </div>
                        </div>
                        
                        <div class="tab-pane fade py-2" id="tab-links" aria-labelledby="tab-btn-links" role="tabpanel">
                            <div class="dropdown float-right">
                                <button class="btn btn-sm float-right btn-outline-success dropdown-toggle" type="button" id="dropdownLinksMeasures" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Select data to link
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownLinksMeasures">
                                    
                                </div>
                            </div>
                            <div class="mt-4" style="height: 550px; clear: both">
                                <span id="linksTitle" class="home-label"></span>
                                
                                <div id="links" style="width: 100%"></div>
                            </div>
                        </div>
                    </div>

                    <hr class="my-2">
                    <div class="row my-2">
                        <div class="col-md-6">
                            <div class="dropdown">
                                <button class="btn btn-sm btn-outline-light text-secondary" type="button" id="downloadDD" onclick="runDataDownload()"><i class="fa fa-download mr-1"></i>Download Data
                                </button>
                            </div>
                        </div>
                    
                        <div class="col-md-6 ml-auto">
                            <button class="btn float-right btn-sm btn-outline-light text-secondary" onclick="copyCitation()" id="citeButton"><i class="fas fa-copy mr-1"></i>Copy citation</button>
                            <input type="text" id="citeText" value="" style="display:inline-block; width:100%; height: 40px; font-size: 14px;" class="my-2 sr-only">                            
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-6 col-xs-12">
                            <div class="btn-toggle">
                                <button class="btn btn-block btn-md btn-outline-light text-secondary" data-toggle="collapse" data-target="#toggle-target" aria-expanded="false" aria-controls="toggle-target">
                                    <span class="title"><i class="fas fa-info-circle mr-1"></i>About the Measures</span>
                                </button>
                            </div>
                            
                            <div class="collapse p-2" id="toggle-target" role="navigation">
                                <p class="fs-sm indicator-measures">Insert from `How_Calculated.` Vivamus consequat id nibh et tempor. Cras augue enim, iaculis quis purus sit amet, interdum accumsan neque. In blandit varius blandit. Praesent vel leo ac urna dapibus faucibus. Donec sed luctus neque. Nulla porta finibus elit, luctus eleifend felis ornare vitae. Ut consequat laoreet libero eu venenatis.</p>
                    
                            </div>
                        </div>
                    
                        <div class="col-md-6 col-xs-12">
                            <div class="btn-toggle">
                                <button class="btn btn-block btn-md btn-outline-light text-secondary" data-toggle="collapse" data-target="#toggle-target-2" aria-expanded="false" aria-controls="toggle-target-2">
                                    <span class="title"><i class="fas fa-database mr-1"></i>Data sources</span>
                                </button>
                            </div>
                            
                            <div class="collapse p-2" id="toggle-target-2" role="navigation">
                                <p class="fs-sm indicator-sources">Insert from `Sources.` Pellentesque blandit ante vel augue mattis, lacinia tincidunt velit feugiat. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Donec nulla nisl, sollicitudin et volutpat at, finibus ac quam. Pellentesque faucibus turpis egestas tellus luctus, nec porttitor diam bibendum. Sed mauris augue, tempus id urna sit amet, hendrerit blandit libero. Cras sit amet luctus nunc, nec mattis leo. </p>
                    
                            </div>
                        </div>
                    
                    </div>


            
                </div>
            </div>

        </div>
    </div>

                </div>
            </div>

        </div>
    </div>


<div class="modal fade" id="topicModal" tabindex="-1" role="dialog" aria-labelledby="topicModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="topicModalLabel">Change topic</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body px-0">
            <style>
    .accordion-group .card {
        background-color: #f2f2f2;
        margin: 0px;
    }

</style>




<div class="row no-gutters">
    <div class="col-12">

        <div class="accordion-group narrow fs-sm" role="tablist" id="accordion-01">

            <div class="card">

               <strong><a class="card-header bg-light collapse collapsed"
                    id="acc-button-01" data-toggle="collapse"
                    href="#panel-acc-button-01" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-01">
                    <span class="title" role="heading"
                        aria-level="3">Air Quality</span>
                </a></strong> 

                <div class="collapse" id="panel-acc-button-01"
                    role="tabpanel" aria-labelledby="acc-button-01"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/active-design/">Active Design</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/air-quality/">Air Quality</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma/">Asthma</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/health-impacts-of-air-pollution/">Health Impacts of Air Pollution</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/walking-driving-and-cycling/">Walking, Driving, and Cycling</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

            <div class="card">

                <strong><a class="card-header bg-light collapse collapsed"
                    id="acc-button-02" data-toggle="collapse"
                    href="#panel-acc-button-02" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-02">
                    <span class="title" role="heading"
                        aria-level="3">Climate</span>
                </a></strong>

                <div class="collapse" id="panel-acc-button-02"
                    role="tabpanel" aria-labelledby="acc-button-02"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma/">Asthma</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/climate/">Climate</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-safety/">Housing safety</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-stability/">Housing stability</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/vector-borne-disease/">Vector-borne Disease</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/weather-related-illness/">Weather-Related Illness</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

            <div class="card">

               <strong> <a class="card-header bg-light collapse collapsed"
                    id="acc-button-03" data-toggle="collapse"
                    href="#panel-acc-button-03" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-03">
                    <span class="title" role="heading"
                        aria-level="3">Housing</span>
                </a></strong>

                <div class="collapse" id="panel-acc-button-03"
                    role="tabpanel" aria-labelledby="acc-button-03"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma/">Asthma</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma-triggers/">Asthma triggers at home</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/bed-bugs/">Bed Bugs</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cancer/">Cancer</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/carbon-monoxide-incidents/">Carbon monoxide</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cigarette-smoke/">Cigarette Smoke</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cockroaches/">Cockroaches</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/falls-among-older-adults/">Falls Among Older Adults</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-maintenance/">Housing maintenance</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-safety/">Housing safety</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-stability/">Housing stability</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/lead/">Lead poisoning</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/mice-and-rats/">Mice and Rats</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/social-and-economic-conditions/">Social and Economic Conditions</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

            <div class="card">

                <strong><a class="card-header bg-light collapse collapsed"
                    id="acc-button-04" data-toggle="collapse"
                    href="#panel-acc-button-04" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-04">
                    <span class="title" role="heading"
                        aria-level="3">Health equity</span>
                </a></strong>

                <div class="collapse" id="panel-acc-button-04"
                    role="tabpanel" aria-labelledby="acc-button-04"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma/">Asthma</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma-triggers/">Asthma triggers at home</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/health-care/">Health Care</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/health-impacts-of-air-pollution/">Health Impacts of Air Pollution</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-maintenance/">Housing maintenance</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-safety/">Housing safety</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-stability/">Housing stability</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/lead/">Lead poisoning</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/mortality/">Mortality</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/social-and-economic-conditions/">Social and Economic Conditions</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/violence/">Violence</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/weather-related-illness/">Weather-Related Illness</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/worker-health/">Worker Health</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

            <div class="card">

                <strong><a class="card-header bg-light collapse collapsed"
                    id="acc-button-05" data-toggle="collapse"
                    href="#panel-acc-button-05" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-05">
                    <span class="title" role="heading"
                        aria-level="3">Active design / Transportation</span>
                </a></strong>

                <div class="collapse" id="panel-acc-button-05"
                    role="tabpanel" aria-labelledby="acc-button-05"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/active-design/">Active Design</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/air-quality/">Air Quality</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma/">Asthma</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/health-impacts-of-air-pollution/">Health Impacts of Air Pollution</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/noise/">Noise</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/physical-activity/">Physical Activity</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/transportation-related-injuries/">Transportation-related Injuries</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/walking-driving-and-cycling/">Walking, Driving, and Cycling</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

            <div class="card">

                <strong><a class="card-header bg-light collapse collapsed"
                    id="acc-button-06" data-toggle="collapse"
                    href="#panel-acc-button-06" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-06">
                    <span class="title" role="heading"
                        aria-level="3">Health outcomes</span>
                </a></strong>

                <div class="collapse" id="panel-acc-button-06"
                    role="tabpanel" aria-labelledby="acc-button-06"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma/">Asthma</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/birth-defects/">Birth Defects</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/birth-outcomes/">Birth Outcomes</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cancer/">Cancer</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cancers-in-children/">Cancers in Children</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/falls-among-older-adults/">Falls Among Older Adults</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/health-impacts-of-air-pollution/">Health Impacts of Air Pollution</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/mortality/">Mortality</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/overweight/">Overweight</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/transportation-related-injuries/">Transportation-related Injuries</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/vector-borne-disease/">Vector-borne Disease</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/violence/">Violence</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/weather-related-illness/">Weather-Related Illness</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/worker-health/">Worker Health</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

            <div class="card">

                <strong><a class="card-header bg-light collapse collapsed"
                    id="acc-button-07" data-toggle="collapse"
                    href="#panel-acc-button-07" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-07">
                    <span class="title" role="heading"
                        aria-level="3">Child health</span>
                </a></strong>

                <div class="collapse" id="panel-acc-button-07"
                    role="tabpanel" aria-labelledby="acc-button-07"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/air-quality/">Air Quality</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma/">Asthma</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/birth-defects/">Birth Defects</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/birth-outcomes/">Birth Outcomes</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cancer/">Cancer</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cancers-in-children/">Cancers in Children</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/carbon-monoxide-incidents/">Carbon monoxide</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cigarette-smoke/">Cigarette Smoke</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/lead/">Lead poisoning</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

            <div class="card">

                <strong><a class="card-header bg-light collapse collapsed"
                    id="acc-button-08" data-toggle="collapse"
                    href="#panel-acc-button-08" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-08">
                    <span class="title" role="heading"
                        aria-level="3">Pests and pesticides</span>
                </a></strong>

                <div class="collapse" id="panel-acc-button-08"
                    role="tabpanel" aria-labelledby="acc-button-08"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma/">Asthma</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/bed-bugs/">Bed Bugs</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cockroaches/">Cockroaches</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/mice-and-rats/">Mice and Rats</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/pesticides/">Pesticides</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/vector-borne-disease/">Vector-borne Disease</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

            <div class="card">

                <strong><a class="card-header bg-light collapse collapsed"
                    id="acc-button-09" data-toggle="collapse"
                    href="#panel-acc-button-09" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-09">
                    <span class="title" role="heading"
                        aria-level="3">Food and drink</span>
                </a></strong>

                <div class="collapse" id="panel-acc-button-09"
                    role="tabpanel" aria-labelledby="acc-button-09"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/alcohol-use/">Alcohol Access and Use</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/drinking-water-quality/">Drinking Water Quality</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/restaurant-food-safety/">Restaurant Food Safety</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/sugary-drink-consumption/">Sugary Drink Consumption</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

            <hr class="my-2">

            <div class="card">

                <strong><a class="card-header bg-light collapse collapsed"
                    id="acc-button-10" data-toggle="collapse"
                    href="#panel-acc-button-10" role="tab"
                    aria-expanded="false"
                    aria-controls="panel-acc-button-10">
                    <span class="title" role="heading"
                        aria-level="3">All topics</span>
                </a></strong>

                <div class="collapse" id="panel-acc-button-10"
                    role="tabpanel" aria-labelledby="acc-button-10"
                    data-parent="#accordion-01">

                    <div class="card-body">
                        <ul>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/active-design/">Active Design</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/air-quality/">Air Quality</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/alcohol-use/">Alcohol Access and Use</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/all-data/">All Data Sets</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma/">Asthma</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/asthma-triggers/">Asthma triggers at home</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/bed-bugs/">Bed Bugs</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/birth-defects/">Birth Defects</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/birth-outcomes/">Birth Outcomes</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cancer/">Cancer</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cancers-in-children/">Cancers in Children</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/carbon-monoxide-incidents/">Carbon monoxide</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cigarette-smoke/">Cigarette Smoke</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/climate/">Climate</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/cockroaches/">Cockroaches</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/drinking-water-quality/">Drinking Water Quality</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/falls-among-older-adults/">Falls Among Older Adults</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/health-care/">Health Care</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/health-impacts-of-air-pollution/">Health Impacts of Air Pollution</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-maintenance/">Housing maintenance</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-safety/">Housing safety</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/housing-stability/">Housing stability</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/lead/">Lead poisoning</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/mice-and-rats/">Mice and Rats</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/mortality/">Mortality</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/noise/">Noise</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/overweight/">Overweight</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/pesticides/">Pesticides</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/physical-activity/">Physical Activity</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/restaurant-food-safety/">Restaurant Food Safety</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/social-and-economic-conditions/">Social and Economic Conditions</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/solid-waste/">Solid Waste</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/sugary-drink-consumption/">Sugary Drink Consumption</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/transportation-related-injuries/">Transportation-related Injuries</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/vector-borne-disease/">Vector-borne Disease</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/violence/">Violence</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/walking-driving-and-cycling/">Walking, Driving, and Cycling</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/weather-related-illness/">Weather-Related Illness</a>
                                </li>
                            
                                <li><a href="https://nychealth.github.io/EH-dataportal/data-explorer/worker-health/">Worker Health</a>
                                </li>
                            
                            </ul>
                    </div>

                </div>
                

            </div>
            

        </div>
        
    </div>
</div>


<script>
    var subtopic_indicators = {"active-design":{"IndicatorID":[2390,2181,2158,2157,2143,2388,2391,2389,2133],"subtopic_name":"Active Design"},"air-quality":{"IndicatorID":[92,57,55,2024,2023,2028,2025,2027,2026],"subtopic_name":"Air Quality"},"alcohol-use":{"IndicatorID":[2049,2057,2050,2051,2056,2055],"subtopic_name":"Alcohol Access and Use"},"asthma":{"IndicatorID":[2380,2384,2048,2378,2379,2383,2382,2387,84,2381,2386,18,2392,2147,2149,2339],"subtopic_name":"Asthma"},"asthma-triggers":{"IndicatorID":[2101,25,2393,2394,107,48],"subtopic_name":"Asthma triggers at home"},"bed-bugs":{"IndicatorID":[2030],"subtopic_name":"Bed Bugs"},"birth-defects":{"IndicatorID":[26,30,31,36,37,33,28,32,35,27,101,29,34],"subtopic_name":"Birth Defects"},"birth-outcomes":{"IndicatorID":[5,4,6,7,8,1,9,3,2],"subtopic_name":"Birth Outcomes"},"cancer":{"IndicatorID":[74,2096,66,60,770,2077,2087,2088,73,2089,63,2090,2095,71,2091,64,690],"subtopic_name":"Cancer"},"cancers-in-children":{"IndicatorID":[2037,2035,2033,2031,2039],"subtopic_name":"Cancers in Children"},"carbon-monoxide-incidents":{"IndicatorID":[38,2168,2398,2405,2406],"subtopic_name":"Carbon monoxide"},"cigarette-smoke":{"IndicatorID":[2338,2020,2017,2019,2021,25],"subtopic_name":"Cigarette Smoke"},"climate":{"IndicatorID":[2141,2143,2084,2191,2411,2155,2104,2185,2377],"subtopic_name":"Climate"},"cockroaches":{"IndicatorID":[22,2393,107],"subtopic_name":"Cockroaches"},"drinking-water-quality":{"IndicatorID":[2207,2044,2043,2041],"subtopic_name":"Drinking Water Quality"},"falls-among-older-adults":{"IndicatorID":[2135,2136,2408,2409,2403,2188],"subtopic_name":"Falls Among Older Adults"},"health-care":{"IndicatorID":[2151,2132,2401,2232],"subtopic_name":"Health Care"},"health-impacts-of-air-pollution":{"IndicatorID":[2122,2124,2121,2117,2120,2108,2119],"subtopic_name":"Health Impacts of Air Pollution"},"housing-maintenance":{"IndicatorID":[2396,2395,46,47,45,40,42,41,2399,2179],"subtopic_name":"Housing maintenance"},"housing-safety":{"IndicatorID":[2365,15,17,2188,2185,2377,2336],"subtopic_name":"Housing safety"},"housing-stability":{"IndicatorID":[2365,15,17,2188,2185,2377,2336],"subtopic_name":"Housing stability"},"lead":{"IndicatorID":[2189,2184,2216,2176,16,2209,41],"subtopic_name":"Lead poisoning"},"mice-and-rats":{"IndicatorID":[2394,2105,24,48],"subtopic_name":"Mice and Rats"},"mortality":{"IndicatorID":[5,6,8,2322],"subtopic_name":"Mortality"},"noise":{"IndicatorID":[2134],"subtopic_name":"Noise"},"overweight":{"IndicatorID":[2063,2064,2061,2062],"subtopic_name":"Overweight"},"pesticides":{"IndicatorID":[2235,91,100,2312,96,94,93,99,97,98,102,2366,2364,2367,2368,2369,2374,2370],"subtopic_name":"Pesticides"},"physical-activity":{"IndicatorID":[2060,2058,2173,2059,2172],"subtopic_name":"Physical Activity"},"restaurant-food-safety":{"IndicatorID":[2065],"subtopic_name":"Restaurant Food Safety"},"social-and-economic-conditions":{"IndicatorID":[2145,2176,14,2334,2317,2335,2146,2073,103,2325,2336,2323,2337,2389,2365,15,17],"subtopic_name":"Social and Economic Conditions"},"solid-waste":{"IndicatorID":[],"subtopic_name":"Solid Waste"},"sugary-drink-consumption":{"IndicatorID":[2097,2098],"subtopic_name":"Sugary Drink Consumption"},"transportation-related-injuries":{"IndicatorID":[2092,2086,2094,2093],"subtopic_name":"Transportation-related Injuries"},"vector-borne-disease":{"IndicatorID":[2218,2340],"subtopic_name":"Vector-borne Disease"},"violence":{"IndicatorID":[2400,2375],"subtopic_name":"Violence"},"walking-driving-and-cycling":{"IndicatorID":[2113,2236,2237,2238,2058,2173,2059,2172,2133,2114,2112],"subtopic_name":"Walking, Driving, and Cycling"},"weather-related-illness":{"IndicatorID":[2376,2175,2174,2410,2084,2074,2075,2076,2191,2411],"subtopic_name":"Weather-Related Illness"},"worker-health":{"IndicatorID":[2209,2211,2208,2210,2214,2239,2215],"subtopic_name":"Worker Health"}};
    console.log(subtopic_indicators)

    var destination = document.getElementById('indicatorNames')    

    function changeKT(x) {
        console.log(x)
        const all = document.querySelectorAll('.dumps')
        all.forEach((dump) => {
            dump.classList.remove('show')
            dump.classList.add('hide')
        });
        const chosen = 'output'+x
        console.log('chosen: ' + chosen)
        document.getElementById(chosen).classList.remove('hide')

        const KTs = document.querySelectorAll('.kt')
        KTs.forEach((kt) => {
            kt.classList.remove('active')
        });

        const link = 'kt'+x
        document.getElementById(link).classList.add('active')
    }

</script>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>


<div class="modal fade" id="aboutModal" tabindex="-1" role="dialog" aria-labelledby="aboutModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="aboutModalLabel">About Sugary Drink Consumption</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            <p>Sugary drinks contribute to a higher-calorie diet, long-term weight gain, and increased risk of heart disease and diabetes. Sugary drinks provide little or no nutritional value, and because they dont fill you up the way food does, you end up consuming more calories. Also, food and beverage portion sizes have exploded over the past several decades, and studies have shown that when given larger portions, people consume more without recognizing it.</p>
<h3 id="sugary-drinks-and-health">Sugary Drinks and Health</h3>
<p>Obesity is at epidemic proportions in New York City. More than half of New York City adults (58%) are overweight or obese; nearly 40% of New York Citys public school students (K-8) are obese or overweight; and the percentage of adults with diagnosed diabetes is increasing, with nearly 10% of New Yorkers now diagnosed with diabetes.</p>
<h3 id="about-the-data-and-indicators">About the Data and Indicators</h3>
<p>Sugary drink consumption indicators presented on this site are derived from the annual NYC Youth Risk Behavior Surveys and the Community Health Surveys. They are estimates that depend on study participants&rsquo; accurate recollections and reporting.</p>
<h3 id="prevention">Prevention</h3>
<p>Make healthier choices:</p>
<ul>
<li>Drink plenty of water; nothing quenches thirst better than water.</li>
<li>Choose fat-free or 1% milk.</li>
<li>Switch from juice to whole fruit; whole fruit has fewer calories, and unlike juice, it has fiber.</li>
<li>Skip sports drinks and energy drinks; most are high in sugar and low in nutrients, and energy drinks are loaded with caffeine.</li>
<li>Pass on the high-calorie sweetened coffee and tea drinks; instead, order your coffee or tea plain and lightly flavor it yourself.</li>
<li>Choose smaller portions.</li>
</ul>
<h3 id="key-messages">Key Messages</h3>
<p>Sugary drinks are a major contributor to obesity  and obesity is a risk factor for heart disease and diabetes.</p>
<p>Residents of poor neighborhoods consume more sugary drinks than residents of wealthier neighborhoods.</p>
<p>There are numerous healthy alternatives to sugary drinks, such as water, seltzer, fat-free or 1% milk, and unsweetened tea.</p>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>




</article>



<script type="text/javascript" src="https://nychealth.github.io/EH-dataportal/js/accessible-autocomplete.min.js" integrity=""></script>

<script type="text/javascript"> 
    
    function populateDropDownList() {          
           var ddlData = document.getElementById("all-data");
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Data Explorer"
            
            option.value = '\/EH-dataportal/\/data-explorer\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Active Design"
            
            option.value = '\/EH-dataportal/\/data-explorer\/active-design\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Air Quality"
            
            option.value = '\/EH-dataportal/\/data-explorer\/air-quality\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Alcohol Access and Use"
            
            option.value = '\/EH-dataportal/\/data-explorer\/alcohol-use\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "All Data Sets"
            
            option.value = '\/EH-dataportal/\/data-explorer\/all-data\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Asthma"
            
            option.value = '\/EH-dataportal/\/data-explorer\/asthma\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Asthma triggers at home"
            
            option.value = '\/EH-dataportal/\/data-explorer\/asthma-triggers\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Bed Bugs"
            
            option.value = '\/EH-dataportal/\/data-explorer\/bed-bugs\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Birth Defects"
            
            option.value = '\/EH-dataportal/\/data-explorer\/birth-defects\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Birth Outcomes"
            
            option.value = '\/EH-dataportal/\/data-explorer\/birth-outcomes\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Cancer"
            
            option.value = '\/EH-dataportal/\/data-explorer\/cancer\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Cancers in Children"
            
            option.value = '\/EH-dataportal/\/data-explorer\/cancers-in-children\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Carbon monoxide"
            
            option.value = '\/EH-dataportal/\/data-explorer\/carbon-monoxide-incidents\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Cigarette Smoke"
            
            option.value = '\/EH-dataportal/\/data-explorer\/cigarette-smoke\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Climate"
            
            option.value = '\/EH-dataportal/\/data-explorer\/climate\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Cockroaches"
            
            option.value = '\/EH-dataportal/\/data-explorer\/cockroaches\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Drinking Water Quality"
            
            option.value = '\/EH-dataportal/\/data-explorer\/drinking-water-quality\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Falls Among Older Adults"
            
            option.value = '\/EH-dataportal/\/data-explorer\/falls-among-older-adults\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Health Care"
            
            option.value = '\/EH-dataportal/\/data-explorer\/health-care\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Health Impacts of Air Pollution"
            
            option.value = '\/EH-dataportal/\/data-explorer\/health-impacts-of-air-pollution\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Housing maintenance"
            
            option.value = '\/EH-dataportal/\/data-explorer\/housing-maintenance\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Housing safety"
            
            option.value = '\/EH-dataportal/\/data-explorer\/housing-safety\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Housing stability"
            
            option.value = '\/EH-dataportal/\/data-explorer\/housing-stability\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Lead poisoning"
            
            option.value = '\/EH-dataportal/\/data-explorer\/lead\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Mice and Rats"
            
            option.value = '\/EH-dataportal/\/data-explorer\/mice-and-rats\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Mortality"
            
            option.value = '\/EH-dataportal/\/data-explorer\/mortality\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Noise"
            
            option.value = '\/EH-dataportal/\/data-explorer\/noise\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Overweight"
            
            option.value = '\/EH-dataportal/\/data-explorer\/overweight\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Pesticides"
            
            option.value = '\/EH-dataportal/\/data-explorer\/pesticides\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Physical Activity"
            
            option.value = '\/EH-dataportal/\/data-explorer\/physical-activity\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Restaurant Food Safety"
            
            option.value = '\/EH-dataportal/\/data-explorer\/restaurant-food-safety\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Social and Economic Conditions"
            
            option.value = '\/EH-dataportal/\/data-explorer\/social-and-economic-conditions\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Solid Waste"
            
            option.value = '\/EH-dataportal/\/data-explorer\/solid-waste\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Sugary Drink Consumption"
            
            option.value = '\/EH-dataportal/\/data-explorer\/sugary-drink-consumption\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Transportation-related Injuries"
            
            option.value = '\/EH-dataportal/\/data-explorer\/transportation-related-injuries\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Vector-borne Disease"
            
            option.value = '\/EH-dataportal/\/data-explorer\/vector-borne-disease\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Violence"
            
            option.value = '\/EH-dataportal/\/data-explorer\/violence\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Walking, Driving, and Cycling"
            
            option.value = '\/EH-dataportal/\/data-explorer\/walking-driving-and-cycling\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Weather-Related Illness"
            
            option.value = '\/EH-dataportal/\/data-explorer\/weather-related-illness\/'
            
            ddlData.options.add(option);
           
            var option = document.createElement("OPTION");
            
            option.innerHTML = "Worker Health"
            
            option.value = '\/EH-dataportal/\/data-explorer\/worker-health\/'
            
            ddlData.options.add(option);
          
       };

       populateDropDownList(); 

       
       var selectEl = document.querySelector('#all-data')
        accessibleAutocomplete.enhanceSelectElement({
        autoselect: true,
        confirmOnBlur: true,
        defaultValue: "",
        minLength: 2,
        selectElement: selectEl
            });


    
    var dataSearchForm = document.getElementById('all-data-select') 
    document.querySelector('form.autocomplete-form').addEventListener("submit", function (e) {
        e.preventDefault(); 
        window.location.assign(DOMPurify.sanitize(dataSearchForm.options[dataSearchForm.selectedIndex].value))
      });

function createCitation() {
    
    var today = new Date();
    var dd = String(today.getDate()).padStart(2, '0');
    var mm = String(today.getMonth() + 1).padStart(2, '0'); 
    var yyyy = today.getFullYear();
    today = mm + '/' + dd + '/' + yyyy;

    
    var citation = "New York City Department of Health, Environment & Health Data Portal. "  + `"Sugary Drink Consumption"` + " data. " + indicatorName + '. Accessed at ' + `"https://nychealth.github.io/EH-dataportal/data-explorer/sugary-drink-consumption/"` + ' on ' + today + "."

    
    document.getElementById('citeText').setAttribute('value',citation);

    console.log('CITATION CREATED')

    var btn = document.getElementById('citeButton')
    btn.innerHTML = `<i class="fas fa-copy mr-1"></i>Copy citation`

}

function copyCitation(){
    var citeText = document.getElementById('citeText')
    citeText.select()
    citeText.setSelectionRange(0,99999);
    navigator.clipboard.writeText(citeText.value)
    var btn = document.getElementById('citeButton')
    btn.innerHTML = `<i class="fas fa-copy mr-1"></i>Copied!`
    console.log('citation copied!')
}

createCitation();

var downloadTable;
var dataURL; 
var downloadTableCSV
var csvData


function runDataDownload() {
console.log('Downloading data for indicator ' + indicatorId)
dataURL = 'https://raw.githubusercontent.com/nychealth/EHDP-data/main/indicators/data/' + indicatorId + '.json'
console.log('Data are at: ' + dataURL)
aq.loadJSON(`${dataURL}`).then(function(data) {
    downloadTable = data;
    downloadTableCSV = downloadTable.toCSV()
    
    csvData = 'data:application/csv;charset=utf-8,' + encodeURIComponent(downloadTableCSV);
    var hiddenElement = document.createElement('a');  
    hiddenElement.href = csvData;
    hiddenElement.target = '_blank';  
    hiddenElement.download = 'NYC EH Data Portal: ' + indicatorName + '.csv'
    hiddenElement.click();
})
}

   </script>

<ul id="results"></ul>
  </main>
  
  <div class="modal" tabindex="-1" role="dialog" id="prototypeModal">
    <div class='modal-dialog modal-lg modal-dialog-centered' role='document'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h5 class='modal-title'>Welcome to the Prototype EH Data website. </h5>
            </div>
            <div class='modal-body'>
                <p>This prototype is a work in progress. That means that not all of the data or information is final.
                    But, feel free to click around and explore.
                </p>
                <p><strong>Please sign up for our email list</strong>. We will email you every few months with updates,
                    or opportunities to participate in user research. 
                    <a href='https://docs.google.com/forms/d/e/1FAIpQLSfUg3JE5ODNc6aqBPJwM8mZ80TYtK6ISw-OM7PBwKuoN3M--g/viewform'>Click here to sign up</a>.
                </p>
            </div>
            <hr>
            <button type="button" class="btn btn-outline-primary close-dialog" data-dismiss="modal">Close</button>
        </div>
    </div>
</div>

<script src="../../js/conditional-modal.js"></script>
<footer class="bg-black" id="global-footer" role="contentinfo">

  <h2 class="sr-only">
      Page Footer
  </h2>

  <div class="bg-opacity-black-25 text-white" id="nyc-footer">

      <div class="container py-3 d-none" id="languages">

          <div class="row fs-md">

              <div class="col-6 col-md-4 col-lg mb-2 mb-lg-0">
                  <ul class="extensible-list">
                      <li><a class="lang-select text-reset" href="#" data-lang="ar"></a></li>
                      <li><a class="lang-select text-reset" href="#" data-lang="bn"></a></li>
                  </ul>
              </div>
              <div class="col-6 col-md-4 col-lg mb-2 mb-lg-0">
                  <ul class="extensible-list">
                      <li><a class="lang-select text-reset" href="#" data-lang="zh-CN"></a></li>
                      <li><a class="lang-select text-reset" href="#" data-lang="fr">franais</a></li>
                  </ul>
              </div>
              <div class="col-6 col-md-4 col-lg mb-2 mb-lg-0">
                  <ul class="extensible-list">
                      <li><a class="lang-select text-reset" href="#" data-lang="ht">Kreyl Ayisyen</a></li>
                      <li><a class="lang-select text-reset" href="#" data-lang="ko"></a></li>
                  </ul>
              </div>
              <div class="col-6 col-md-4 col-lg mb-2 mb-lg-0">
                  <ul class="extensible-list">
                      <li><a class="lang-select text-reset" href="#" data-lang="pl">Polskie</a></li>
                      <li><a class="lang-select text-reset" href="#" data-lang="ru"></a></li>
                  </ul>
              </div>
              <div class="col-6 col-md-4 col-lg">
                  <ul class="extensible-list">
                      <li><a class="lang-select text-reset" href="#" data-lang="es">Espaol</a></li>
                      <li><a class="lang-select text-reset" href="#" data-lang="ur"></a></li>
                  </ul>
              </div>
          </div>

      </div>
      

      <div class="container py-3" id="languages">

          <ul class="fs-md" role="list">
              <li><a class="lang-select text-reset" href="#" data-lang="ar"></a></li>
              <li><a class="lang-select text-reset" href="#" data-lang="bn"></a></li>
              <li><a class="lang-select text-reset" href="#" data-lang="zh-CN"></a></li>
              <li><a class="lang-select text-reset" href="#" data-lang="fr">franais</a></li>
              <li><a class="lang-select text-reset" href="#" data-lang="ht">Kreyl Ayisyen</a></li>
              <li><a class="lang-select text-reset" href="#" data-lang="ko"></a></li>
              <li><a class="lang-select text-reset" href="#" data-lang="pl">Polskie</a></li>
              <li><a class="lang-select text-reset" href="#" data-lang="ru"></a></li>
              <li><a class="lang-select text-reset" href="#" data-lang="es">Espaol</a></li>
              <li><a class="lang-select text-reset" href="#" data-lang="ur"></a></li>
          </ul>

      </div>
      

      <hr class="opacity-10" aria-hidden="true">

      <div class="container py-3">
          <div class="row">
              <div class="col-md-6 col-lg-8 mb-3 mb-lg-0">
                  <nav class="row fs-md" role="navigation">
                      <div class="col-lg mb-3 mb-lg-0">
                          <ul class="extensible-list">
                              <li>
                                  <a class="text-reset" href="https://www1.nyc.gov/nyc-resources/agencies.page">
                                      <strong>City Agencies</strong>
                                  </a>
                              </li>
                              <li>
                                  <a class="text-reset" href="https://a858-nycnotify.nyc.gov/notifynyc/">
                                      <strong>Notify NYC</strong>
                                  </a>
                              </li>
                              <li>
                                  <a class="text-reset"
                                      href="https://www1.nyc.gov/connect/mobile-applications.page">
                                      <strong>NYC Mobile Apps</strong>
                                  </a>
                              </li>
                          </ul>
                      </div>
                      

                      <div class="col-lg mb-3 mb-lg-0">

                          <ul class="extensible-list">
                              <li>
                                  <a class="text-reset" href="https://www1.nyc.gov/home/contact-us.page">
                                      <strong>Contact NYC Government</strong>
                                  </a>
                              </li>
                              <li>
                                  <a class="text-reset" href="https://a856-citystore.nyc.gov/">
                                      <strong>CityStore</strong>
                                  </a>
                              </li>
                              <li>
                                  <a class="text-reset" href="https://maps.nyc.gov/doitt/nycitymap/">
                                      <strong>Maps</strong>
                                  </a>
                              </li>
                          </ul>

                      </div>
                      

                      <div class="col-lg mb-3 mb-lg-0">

                          <ul class="extensible-list">
                              <li>
                                  <a class="text-reset"
                                      href="https://a127-ess.nyc.gov/psp/prdess/?cmd=login&languageCd=ENG&">
                                      <strong>City Employees</strong>
                                  </a>
                              </li>
                              <li>
                                  <a class="text-reset" href="https://www1.nyc.gov/connect/social-media.page">
                                      <strong>Stay Connected</strong>
                                  </a>
                              </li>
                              <li>
                                  <a class="text-reset"
                                      href="https://www1.nyc.gov/nyc-resources/resident-toolkit.page">
                                      <strong>Resident Toolkit</strong>
                                  </a>
                              </li>
                          </ul>
                      </div>
                      

                  </nav>
              </div>
              

              <div class="col-md-6 col-lg-4">

                  <a class="mb-2" href="https://www1.nyc.gov" title="Go to nyc.gov" target="_blank">
                      
                      <img class="mb-2" src="https://nychealth.github.io/EH-dataportal/images/nyc-bubble-logo.svg" width="90" alt="NYC Logo">
                      <span class="sr-only">(opens in a new tab)</span>
                  </a>
                  <p class="fs-sm">City of New York - 2019 All Rights Reserved. NYC is a trademark and service
                      mark of the City of New York.</p>

                  <ul class="extensible-list horizontal fs-sm">
                      <li>
                          <a class="text-reset" href="https://www1.nyc.gov/home/privacy-policy.page">Privacy
                              Policy</a>
                      </li>
                      <li>
                          <a class="text-reset" href="https://www1.nyc.gov/home/terms-of-use.page">Terms
                              of Use</a>
                      </li>
                      <li>
                          <a class="text-reset" href="https://www1.nyc.gov/site/mopd/index.page"
                              title="Mayor's Office for People with Disabilities">
                              <span class="sr-only">Mayor's Office for People with Disabilities</span>
                              <span class="fab fa-lg fa-accessible-icon"></span>
                          </a>
                      </li>
                  </ul>

              </div>
              

          </div>
          

      </div>
      

  </div>
  

</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>


<script>
  function googleTranslateElementInit() {
      new google.translate.TranslateElement({
          pageLanguage: 'en'
      }, 'google_translate_element');
  }
</script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script src="https://unpkg.com/lunr/lunr.js"></script>
<script src="https://unpkg.com/lunr/lunr.js"></script>
<script type="text/javascript" src="https://nychealth.github.io/EH-dataportal/js/search.js" integrity=""></script></body>
</html>
